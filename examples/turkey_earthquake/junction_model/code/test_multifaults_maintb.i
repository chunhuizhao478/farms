[Mesh]
    [./msh]
        type = FileMeshGenerator
        file = '../mesh/junctionfaults.msh'
    []
    [./subdomain_mainpath_id]
        input = msh
        type = ElementSubdomainIDGenerator 
        element_ids = '
        487 873 1332 9476 404308 404938 406082 406199 406449 406476 406491 406507 406528 406546 406557 406569 406577 406592 406594 406596 406609 406625 406639 406650 406664 406673 406686 406695 406707 406716 406729 407757 407899 407990 408097 408294 408297 408324 408340 408342 408349 408351 408356 408360 408373 408376 408377 408378 408384 408385 408388 408393 408395 408402 408403 408407 408408 408410 408411 408413 408416 408424 408429 408430 408431 408434 408439 408443 408447 408450 408452 408460 408464 408470 408476 408483 408485 408492 408496 408501 408506 408509 408512 408517 408521 408531 408536 408537 408539 408542 408544 408545 408554 408558 408559 408565 408571 408574 408577 408578 408579 408580 408582 408584 408586 408587 408596 408605 408606 408614 408615 408623 408626 408630 408634 408636 408639 408641 408646 408647 408648 408649 408657 408658 408659 408662 408663 408664 408691 408698 408701 408703 408716 408747 408752 408788 408835 408872 408907 409247 409348 409399 411641 411849 411957 414112 414246 416805 416877 416954 416960 416966 416969 416974 416979 416984 416989 416995 417001 417012 417020 417028 417031 417039 417046 417051 417057 417067 417073 417080 417085 417089 417093 417099 417102 417109 417115 417122 417129 417134 417138 417143 417149 417155 417162 417169 417170 417172 417194 417217 417222 417228 417234 417239 417243 417249 417253 417259 417263 417270 417275 417281 417286 417289 417293 417297 417301 417306 417312 417321 417325 417331 417335 417340 417346 417355 417360 417367 417375 417381 417388 417395 417401 417407 417410 417416 417421 417427 417433 417441 417445 417449 417452 417458 417461 417464 417470 417476 417482 417485 417492 417496 417499 417503 417506 417508 417514 417518 417523 417526 417529 417533 417537 417541 417546 417552 417558 417561 417564 417566 417573 417576 417580 417585 417589 417593 417597 417602 417609 417617 417619 417623 417628 417632 417633 417639 417647 417660 417665 417673 417675 417680 417684 417686 417692 417700 417704 417708 417712 417715 417718 417722 417727 417728 417733 417736 417789 417849 417893 418651 418745 418937 599 1630 2243 3966 5693 406979 407890 409581 412999 413007 413012 413013 413018 413023 413026 413031 413033 413037 413043 413046 413052 413055 413058 413061 413068 413071 413072 413077 413083 413088 413093 413098 413106 413111 413124 413130 413135 413140 413143 413145 413149 413154 413157 413165 413172 413177 413184 413191 413203 413207 413212 413218 413226 413227 413234 413238 413247 413252 413259 413268 413273 413281 413288 413293 413302 413308 413317 413321 413328 413334 413341 413348 413351 413359 413363 413371 413380 413390 413398 413402 413410 413413 413419 413422 413428 413436 413446 413451 413458 413466 413470 413474 413477 413483 413489 413493 413502 413505 413510 413512 413518 413524 413527 413531 413534 413537 413541 413545 413553 413555 413559 413562 413566 413568 413569 413573 413578 413580 413584 413588 413592 413593 413596 413597 413601 413607 413611 413616 413622 413626 413633 413635 413639 413646 413651 413654 413660 413665 413669 413674 413681 413685 413689 413692 413696 413700 413706 413708 413714 413719 413723 413726 413731 413733 413738 413744 413748 413756 413761 413769 413773 413782 413788 413793 413805 413808 413812 413818 413821 413823 413827 413828 413831 413832 413836 413841 413844 413849 413855 413857 413860 413862 413865 413868 413872 413876 413880 413883 413886 413891 413897 413903 413908 413911 413916 413917 413920 413921 413927 413933 413940 413944 413949 413950 413952 413957 413962 413966 413971 413972 413978 413982 413986 413987 413990 413992 413994 413998 414003 414006 414010 414013 414016 414018 414021 414022 414027 414033 414040 414044 414046 414055 414059 414064 414067 414071 414073 414079 414081 414085 414087 414090 414092 414095 414098 414100 414102 414104 414108 414111 414115 414121 414122 414123 414126 414131 414139 414140 414142 414148 414152 414158 414164 414170 414172 414173 414178 414184 414185 414190 414194 414198 414200 414203 414209 414215 414220 414222 414224 414230 414235 414238 414240 414243 414248 414251 414253 414255 414256 414263 414267 414270 414273 414275 414279 414285 414288 414294 414409 419125 330 336 393 400 426 797 1427 1448 1662 1670 1792 1801 1972 1978 2121 2133 3406 3510 3524 3539 3551 3553 3570 3659 3668 3681 3690 3703 3705 3721 3733 3746 3760 3842 3861 3869 3874 3885 3899 3918 3927 3983 4030 4039 4078 4088 4118 4171 4188 4229 4246 4263 4276 4313 4337 4412 4427 4448 4520 4524 4536 4581 4639 4701 4711 4721 4766 4806 4819 4828 4843 4844 4866 4903 4940 4963 4985 5047 5076 5100 5106 5128 5176 5209 5241 5289 5326 5348 5378 5407 5429 5436 5466 5471 5636 5666 5696 5711 5746 5786 5792 5819 5848 5869 5885 5911 5922 5958 5975 5990 6023 6058 6067 6074 6076 6087 6112 6119 6143 6149 6177 6279 6297 6375 6419 6462 6469 6507 6512 6539 6574 6588 6635 6730 6790 6878 7143 7162 7230 7251 7296 7357 7424 7432 7443 7444 7451 7453 7456 7458 7459 7461 7462 7463 7464 7468 7470 7473 7474 7475 7479 7480 7481 7484 7485 7487 7488 7489 7490 7491 7492 7494 7496 7497 7504 7506 7508 7512 7513 7535 7537 7538 7540 7545 7550 7552 7553 7555 7590 7608 7617 7631 7632 7641 7685 7782 8013 8014 8069 8171 8255 8504 8622 8663 8667 8896 8912 8969 8981 8982 8992 8994 8998 9156 9234 9271 9276 9358 9972 9973 10058 10072 10268 10424 10731 10814 10836 10875 11008 11096 11286 11373 11382 11978 12015 12137 12138 12161 12319 12336 12417 12490 12499 12557 12611 12665 12910 13205 13220 13822 14217 14347 14702 14752 14767 15387 15686 16099 16403 16552 16800 17153 17448 17677 18332 18897 18963 18968 19898 20410 20570 20749 20817 21547 23231 25437 26118 28475 28512 29015 30273 30561 32442 35612 36062 39342 46308 60038 63126 63555 64923 65715 68252 69495 73262 75683 79292 80459 81460 82688 85504 87083 93336 97069 100739 124749 126587 130452 130787 136012 140646 145822 147152 150409 153012 158571 173655 174264 175391 176648 179063 180744 181664 187555 187655 193666 197654 232355 232738 235247 237799 238454 241430 241743 245426 245912 259402 262493 263869 298181 334733 353234 356990 364900 370777 372155 374430 376733 377189 377426 377507 379480 380063 381396 381717 381997 382446 382547 382743 383221 384289 384390 384548 384724 384865 385782 386003 386203 386853 387108 387212 387939 388213 388246 389185 389246 390158 390605 391138 391147 391697 391733 391794 391873 392002 392053 392662 392920 392921 393308 393646 393847 394036 394389 394706 395237 395500 395701 395733 396079 396176 396443 396822 397142 397459 397727 398054 398343 398632 398851 399162 399364 399624 399820 399843 399992 400147 400312 400477 400524 400622 400731 400743 400892 401012 401145 401269 401376 401489 401631 401724 401843 401964 402112 402209 402323 402442 402541 402644 402769 402843 402931 402977 403033 403095 403166 403222 403289 403409 403495 403578 403630 403696 403744 403794 403854 403916 403972 404015 404068 404124 404170 404228 404281 404333 404368 404384 404431 404485 404538 404576 404648 404708 404758 404824 404887 404934 404979 404988 405044 405086 405135 405181 405230 405278 405333 405376 405458 405510 405562 405603 405648 405689 405695 405706 405758 405806 405852 405895 405933 405967 405998 406045 406110 406171 406223 406265 406296 406338 406383 406424 406441 406474 406511 406555 406601 406629 406670 406701 406723 406755 406795 406828 406860 406885 406888 406913 406953 406992 407025 407061 407105 407139 407171 407199 407239 407274 407301 407332 407363 407396 407421 407442 407482 407504 407541 407563 407593 407626 407655 407682 407698 407726 407755 407790 407820 407853 407880 407904 407937 407964 407997 408026 408047 408069 408090 408110 408135 408168 408193 408215 408243 408264 408281 408300 408321 408343 408372 408400 408427 408462 408500 408534 408555 408585 408609 408635 408656 408686 408718 408733 408754 408780 408813 408830 408858 408878 408894 408895 408913 408935 408962 408982 409010 409033 409050 409069 409086 409109 409129 409794 409858 409891 409917 409948 409983 410156 410505 411019 411392 411753 411982 412191 412362 412598 412610 412794 413064 413316 413563 414591 414641 415902 415998 416153 417269 417698 418849 0 1 5 7 14 28 32 38 39 42 47 61 93 106 130 134 140 146 162 191 192 197 203 238 245 254 258 263 290 296 297 302 316 320 334 342 347 382 383 388 390 402 403 412 416 418 419 447 449 467 479 502 503 527 545 562 582 601 602 603 624 625 628 662 682 709 721 748 771 793 800 805 819 820 821 849 863 900 924 934 949 954 956 1008 1020 1037 1050 1059 1073 1091 1103 1114 1126 1128 1132 1141 1162 1167 1182 1196 1212 1222 1228 1270 1300 1302 1313 1319 1350 1413 1466 1494 1510 1513 1518 1587 1631 1657 1663 1697 1705 1737 1746 1758 1769 1806 1819 1827 1860 1867 1917 1936 2053 2056 2062 2080 2089 2114 2135 2142 2168 2169 2191 2194 2196 2256 2271 2305 2326 2348 2375 2378 2380 2381 2483 2509 2579 2594 2602 2605 2648 2652 2661 2712 2722 2724 2735 2742 2744 2745 2793 2798 2848 2866 2901 2910 2955 2985 3006 3007 3022 3023 3025 3032 3056 3101 3143 3158 3214 3257 3296 3298 3309 3343 3355 3403 3424 3429 3430 3439 3457 3476 3499 3502 3532 3549 3560 3614 3688 3707 3717 3719 3724 3749 3758 3816 3833 3860 3937 3942 3950 3969 3981 4019 4025 4027 4037 4053 4077 4137 4193 4216 4222 4232 4234 4258 4277 4311 4317 4340 4343 4373 4415 4432 4439 4441 4555 4590 4592 4608 4638 4640 4650 4686 4743 4747 4764 4833 4839 4892 4902 4938 4954 4969 4970 4994 4998 5064 5087 5113 5193 5232 5280 5295 5296 5356 5411 5442 5463 5479 5483 5495 5513 5553 5656 5676 5706 5707 5727 5803 5853 5856 5923 5977 5984 6276 6366 6390 6393 6427 6443 6579 6594 6621 6627 6638 6649 6745 6821 6893 6972 7044 7094 7177 7273 7320 7367 7698 7707 7817 8055 8315 8352 8425 8547 8597 8688 8970 9053 9089 9139 9209 9940 10810 11092 11149 11232 11294 11673 11936 12163 12652 13028 13199 13254 13824 13938 14581 15333 16148 16719 17607 18870 21791 21885 26315 50902 257586 271342 272167 272973 276669 277630 278589 279682 280753 285857 287370 288880 290762 292574 295208 295966 296552 298945 300184 301140 301265 302084 302996 307567 308675 309765 310967 315099 316570 380952 388727 388793 390111 393248 393286 394852 396539 397220 397518 397537 399949 400225 400230 400279 400984 401162 401260 401432 402187 402693 402897 403415 403444 403445 403480 403721 403752 403846 403976 404075 404320 404348 404446 404465 404712 404914 404994 405083 405120 405279 405367 405375 405490 405587 405609 405932 406087 406185 406400 406462 406513 406582 406712 406757 406783 406810 406996 407003 407020 407042 407322 407599 407611 407813 408015 408046 408131 408191 408244 408298 408303 408317 408379 408392 408397 408769 408910 408912 408931 408961 408981 409007 409018 409031 409049 409083 409160 409223 409265 409317 409432 409470 409539 409570 409682 409712 409750 409779 409833 409853 410003 410063 410237 410472 410568 411690 411713 411799 411809 411869 411878 411886 411911 411967 412016 412091 412114 412120 412195 412229 412234 412317 412361 412364 412441 412486 412504 412510 412528 412576 412581 412673 412697 412701 412897 413005 413017 413021 413091 413110 413112 413239 413255 413464 413468 413606 413680 413697 413718 413778 413794 413815 413879 413936 413979 414038 414120 414150 414202 414225 414226 414244 414361 414381 414387 414436 414444 414479 414515 414537 414560 414586 414597 414612 414626 414710 414728 414732 414745 414766 414812 414856 414857 414899 414923 414945 415038 415055 415062 415096 415128 415134 415138 415158 415179 415258 415327 415331 415391 415432 415449 415559 415643 415714 415735 415774 415820 415831 415839 415920 416059 416088 416152 416160 416183 416275 416286 416384 416412 416415 416485 416500 416503 416523 416602 416823 416878 416910 416924 417104 417223 417392 417423 417446 417495 417512 417555 417600 417636 417743 417768 417779 417821 417885 417920 418023 418058 418101 418108 418133 418155 418201 418281 418495 418590 418654 418767 418947 419106 419124 
        '
        subdomain_ids = '
        100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 
        '
    []
    [./split_mainpath]
        type = BreakMeshByBlockGenerator
        input = subdomain_mainpath_id
        block_pairs = '100 200; 300 400' 
        split_interface = true
    []
    [./subdomain_branchpath_id]
        input = split_mainpath
        type = ElementSubdomainIDGenerator 
        element_ids = '
        4 78 115 144 206 213 217 235 256 257 298 312 328 379 384 455 520 521 537 586 593 743 754 798 799 825 871 873 886 902 910 966 1013 1039 1146 1219 1304 1481 1486 1539 1671 1721 1763 1831 1871 1876 1881 1886 1998 2005 2055 2064 2081 2101 2199 2239 2242 2331 2386 2412 2421 2477 2501 2658 2762 2811 2822 2937 2977 3038 3126 3129 3139 3155 3167 3303 3322 3323 3417 3432 3546 3594 3646 3757 3761 3843 3857 3892 3965 4016 4076 4100 4122 4139 4209 4306 4464 4544 4547 4594 4619 4823 4863 4967 4989 5029 5037 5077 5107 5137 5155 5170 5230 5325 5349 5389 5405 5440 5461 5523 5688 5805 6124 6173 6253 6365 6382 6391 6406 6545 6548 6572 6974 7048 7163 7176 7252 7307 7309 7979 8070 8096 8649 8818 8941 9018 9059 9339 9589 9712 10011 10335 12066 13430 13472 17992 18388 25555 26845 82613 82620 198191 198287 199143 199837 199868 199882 200207 200292 200319 200373 200424 200735 200926 200962 201008 201013 201246 201511 201690 202040 202164 202193 202209 202271 202360 202458 202463 202484 202518 202583 202700 202722 202732 202755 202765 202830 202837 202846 202851 202877 202925 202927 202932 202933 203007 203008 203036 203047 203058 203059 203065 203067 203106 203118 203130 203131 203132 203224 203227 203231 205584 355422 390185 391259 393067 394467 396681 398068 398657 398736 399360 399900 400343 401364 401444 402073 402914 402981 403430 403821 403822 404057 404216 404324 404414 404483 404558 404812 405110 405188 405793 405869 406160 406567 406789 406920 406979 407212 407399 407448 407566 407828 407846 407862 407947 408151 408414 408449 408451 408672 408673 408725 408865 408930 408953 408959 409150 409220 409244 409371 409411 409487 409582 409701 409781 409791 409950 409965 410000 410067 410205 410293 410486 410549 411143 411683 411714 411745 411837 411888 412029 412164 412196 412233 412264 412330 412415 412480 412496 412518 412702 412785 412889 413010 413032 413099 413164 413424 413473 413529 413544 413624 413636 413801 413899 413923 413951 413996 414047 414053 414156 414159 414183 414217 414246 414278 414433 414458 414470 414497 414509 414545 414549 414739 414746 414827 414863 414873 414988 414999 415025 415034 415080 415166 415238 415239 415254 415386 415416 415433 415440 415463 415596 415612 415621 415874 415953 415973 416053 416121 416127 416241 416278 416352 416371 416395 416441 416524 416633 416715 416807 417004 417035 417036 417153 417164 417345 417443 417455 417491 417603 417695 417823 417845 417863 418037 418098 418099 418148 418177 418521 418532 418569 418613 418623 418666 418671 418677 418692 418728 418790 418791 418807 418824 418840 418845 418862 418869 418914 418915 418953 419009 419125 66 85 89 107 161 167 183 196 198 249 457 483 517 523 526 655 712 888 897 1005 1033 1075 1086 1121 1131 1136 1142 1178 1226 1261 1318 1497 1626 1737 1760 1823 1849 1866 1901 1942 1943 1955 1969 2034 2077 2297 2340 2356 2366 2428 2453 2494 2634 2677 2734 2748 2759 2906 2908 2930 2947 3019 3058 3278 3284 3352 3369 3444 3667 3720 3798 3915 3986 3988 4011 4074 4121 4156 4157 4183 4265 4300 4429 4445 4452 4471 4718 5021 5050 5189 5256 5279 5377 5430 5432 5458 5549 5584 5697 5904 5986 6024 6780 6814 6909 6953 6984 7103 7108 7124 7346 7438 7652 7688 8046 8237 8761 9095 9164 9214 9363 9770 10040 10267 10480 11522 11767 12089 13418 13975 14199 15263 15442 18294 20647 20651 20998 73580 77801 81601 88969 89743 91021 91030 91083 91153 91190 91298 91500 92260 92964 93477 93773 93795 94237 95910 96173 96564 96621 97017 97201 97624 97858 98085 98165 101224 101278 101280 101355 101518 101559 101583 101624 101669 102041 102082 102107 102398 102558 103326 103750 104119 104519 104578 104933 105100 105171 105704 106175 106453 108358 108683 109151 109561 109744 110317 110837 111548 112818 113878 114469 114683 115095 115806 116206 116210 116961 117248 117510 117703 117901 118397 119288 119557 119837 120708 120805 121666 121750 121824 123750 123976 124395 124605 125012 125054 125506 125613 125932 126187 126341 127443 128679 129031 129191 129850 129910 130340 132535 132807 133014 133025 133358 133800 135013 140182 141211 141757 142328 142984 144263 145323 146752 147494 147697 150280 152153 386278 394679 395377 395452 399002 400086 400192 400952 401313 402045 402649 403167 403859 404126 404447 404489 404794 404964 405180 405934 406721 406825 406875 406917 406966 406976 407018 407054 407310 407355 407578 407599 407676 407720 408089 408118 408276 408299 408327 408546 408552 408617 408620 408806 408848 408880 408883 409174 409200 409257 409340 409729 409736 410300 410405 410532 410594 410862 410985 411618 411667 411697 411832 411840 411917 412158 412206 412217 412236 412249 412410 412680 412764 412838 413056 413103 413126 413156 413222 413617 413690 413716 413720 413751 413829 413852 413988 414032 414133 414196 414234 414415 414523 414575 414629 414677 414807 414814 414832 414840 414895 414922 414959 414983 414989 415001 415022 415319 415334 415352 415471 415481 415877 415922 415992 416132 416141 416287 416303 416462 416588 416610 416725 416899 416914 416962 417025 417166 417431 417522 417604 417608 417638 417676 417681 417844 417907 417937 418234 418348 418362 418388 418389 418402 418417 418467 418630 418637 418701 418737 418741 418748 418762 418799 418804 418841 418863 418888 418901 418903 418939 418950 419026 
        '
        subdomain_ids = '
        500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 500 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 
        '
    []
    [./split_branchpath]
        type = BreakMeshByBlockGenerator
        input = subdomain_branchpath_id
        block_pairs = '500 600;'
        split_interface = true
    []
    [./sidesets]
        input = split_branchpath
        type = SideSetsFromNormalsGenerator
        normals = '-1 0 0
                    1 0 0
                    0 -1 0
                    0 1 0'
        new_boundary = 'left right bottom top'
    []
[]

[GlobalParams]
    displacements = 'disp_x disp_y'
    q = 0.1
    area = 200
[]

[Variables]
    [./disp_x]
        order = FIRST
        family = LAGRANGE
    [../]
    [./disp_y]
        order = FIRST
        family = LAGRANGE
    [../]
[]

[AuxVariables]
    [./resid_x]
        order = FIRST
        family = LAGRANGE
    [../]
    [./resid_y]
        order = FIRST
        family = LAGRANGE
    []
    [./nodal_area]
        order = FIRST
        family = LAGRANGE
    [../]
    [./resid_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    [../]
    [./resid_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    [../]
    [./disp_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    []
    [./disp_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    [./vel_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    []
    [./vel_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    #import from csv
    [./ini_shear_sts]
        order = CONSTANT
        family = MONOMIAL
    []
    [./ini_normal_sts]
        order = CONSTANT
        family = MONOMIAL
    []
    [./mu_s]
        order = CONSTANT
        family = MONOMIAL
    []
    [./mu_d]
        order = CONSTANT
        family = MONOMIAL
    []
    [./D_c]
        order = CONSTANT
        family = MONOMIAL
    []
    #element value
    [./jump_x]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_x_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_x_rate]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_y]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_y_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_y_rate]
        order = CONSTANT
        family = MONOMIAL
    []
    [./normal_jump]
        order = CONSTANT
        family = MONOMIAL
    []
    [./normal_jump_rate]
        order = CONSTANT
        family = MONOMIAL
    []
    [./tangent_jump]
        order = CONSTANT
        family = MONOMIAL
    []
    [./tangent_jump_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./tangent_jump_rate]
        order = CONSTANT
        family = MONOMIAL
    []
    [./tria_area_aux]
        order = CONSTANT
        family = MONOMIAL
    []
[]

[Modules/TensorMechanics/CohesiveZoneMaster]
    [./czm_ik]
        boundary = 'Block100_Block200 Block300_Block400 Block500_Block600'
        strain = SMALL
        generate_output='normal_jump tangent_jump normal_traction tangent_traction'
    [../]
[]

[Modules]
    [./TensorMechanics]
      [./Master]
        [./all]
          strain = SMALL
          add_variables = true
          planar_formulation = PLANE_STRAIN
          generate_output = 'stress_xx stress_yy stress_xy'
        [../]
      [../]
    [../]
[]

[AuxKernels]
    [Vel_x]
        type = CompVarRate
        variable = vel_slipweakening_x
        coupled = disp_x
        execute_on = 'TIMESTEP_BEGIN'
    []
    [Vel_y]
        type = CompVarRate
        variable = vel_slipweakening_y
        coupled = disp_y
        execute_on = 'TIMESTEP_BEGIN'
    []
    #normal jump rate (element)
    [NJump_rate]
        type = FDCompVarRate
        variable = normal_jump_rate
        coupled = normal_jump
        execute_on = 'TIMESTEP_BEGIN'
    []
    #tangent jump rate (element)
    [TJump_rate]
        type = FDCompVarRate
        variable = tangent_jump_rate
        coupled = tangent_jump_aux
        execute_on = 'TIMESTEP_BEGIN'
    []
    [TJump_var]
        type = CompVar
        variable = tangent_jump_aux
        coupled = tangent_jump
        execute_on = 'TIMESTEP_END'
    []
    [XJump_rate]
        type = FDCompVarRate
        variable = jump_x_rate
        coupled = jump_x_aux
        execute_on = 'TIMESTEP_BEGIN'
    []
    [XJump_var]
        type = CompVar
        variable = jump_x_aux
        coupled = jump_x
        execute_on = 'TIMESTEP_END'
    []
    [YJump_rate]
        type = FDCompVarRate
        variable = jump_y_rate
        coupled = jump_y_aux
        execute_on = 'TIMESTEP_BEGIN'
    []
    [YJump_var]
        type = CompVar
        variable = jump_y_aux
        coupled = jump_y
        execute_on = 'TIMESTEP_END'
    []
    #
    [Displacment_x]
        type = CompVar
        variable = disp_slipweakening_x
        coupled = disp_x
        execute_on = 'TIMESTEP_BEGIN'
    []
    [Displacement_y]
        type = CompVar
        variable = disp_slipweakening_y
        coupled = disp_y
        execute_on = 'TIMESTEP_BEGIN'
    []
    [Residual_x]
        type = CompVar
        variable = resid_slipweakening_x
        coupled = resid_x
        execute_on = 'TIMESTEP_BEGIN'
    []
    [Residual_y]
        type = CompVar
        variable = resid_slipweakening_y
        coupled = resid_y
        execute_on = 'TIMESTEP_BEGIN'
    []
    #func->aux
    [ShearStress]
        type = FunctionAux
        variable = ini_shear_sts
        function = func_ini_shear_sts
        execute_on = 'initial TIMESTEP_BEGIN'
    []
    [NormalStress]
        type = FunctionAux
        variable = ini_normal_sts
        function = func_ini_normal_sts
        execute_on = 'initial TIMESTEP_BEGIN'
    []
    [StaticFricCoeff]
        type = FunctionAux
        variable = mu_s
        function = func_mus
        execute_on = 'initial TIMESTEP_BEGIN'
    []
    [DynamicFricCoeff]
        type = FunctionAux
        variable = mu_d
        function = func_mud
        execute_on = 'initial TIMESTEP_BEGIN'
    []
    [CharacteristicLength]
        type = FunctionAux
        variable = D_c
        function = func_dc
        execute_on = 'initial TIMESTEP_BEGIN'
    []
[]

[Kernels]
    [./inertia_x]
        type = InertialForce
        use_displaced_mesh = false
        variable = disp_x
    []
    [./inertia_y]
        type = InertialForce
        use_displaced_mesh = false
        variable = disp_y
    []
    [./Reactionx]
        type = StiffPropDamping
        variable = 'disp_x'
        component = '0'
    []
    [./Reactiony]
        type = StiffPropDamping
        variable = 'disp_y'
        component = '1'
    []
[]

[Materials]
    [elasticity]
        type = ComputeIsotropicElasticityTensor
        lambda = 32.04e9
        shear_modulus = 32.04e9
        use_displaced_mesh = false
    []
    [stress]
        type = ComputeLinearElasticStress
    []
    [density]
        type = GenericConstantMaterial
        prop_names = density
        prop_values = 2670
    []
    [./czm_mat]
        type = SlipWeakeningTurkeyBranchv4
        disp_slipweakening_x     = disp_slipweakening_x
        disp_slipweakening_y     = disp_slipweakening_y
        reaction_slipweakening_x = resid_slipweakening_x
        reaction_slipweakening_y = resid_slipweakening_y
        nodal_area = nodal_area
        D_c  = D_c
        mu_d = mu_d
        mu_s = mu_s
        ini_shear_sts = ini_shear_sts
        ini_normal_sts = ini_normal_sts
        tria_area = tria_area_aux
        boundary = 'Block100_Block200   Block300_Block400   Block500_Block600'
    [../]
[]
    
[UserObjects]
    [./properties]
        type = PropertyReadFile
        prop_file_name = '../data/faults_elem_properties.csv'
        read_type = 'element'
        nprop = 5
    []
[]

[Functions]
    [func_ini_shear_sts]
        type = PiecewiseConstantFromCSV
        read_prop_user_object = 'properties'
        read_type = 'element'
        column_number = '0'
    []
    [func_ini_normal_sts]
        type = PiecewiseConstantFromCSV
        read_prop_user_object = 'properties'
        read_type = 'element'
        column_number = '1'
    []
    [func_mus]
        type = PiecewiseConstantFromCSV
        read_prop_user_object = 'properties'
        read_type = 'element'
        column_number = '2'
    []
    [func_mud]
        type = PiecewiseConstantFromCSV
        read_prop_user_object = 'properties'
        read_type = 'element'
        column_number = '3'
    []
    [func_dc]
        type = PiecewiseConstantFromCSV
        read_prop_user_object = 'properties'
        read_type = 'element'
        column_number = '4'
    []
[]
    
[Executioner]
    type = Transient
    dt = 0.005
    end_time = 25.0
    #num_steps = 1
    [TimeIntegrator]
        type = CentralDifference
        solve_type = lumped
    []
[]
    
[Outputs]
    exodus = true
    interval = 20
[]

[MultiApps]
    [./sub_app]
        type = TransientMultiApp
        positions = '0 0 0'
        input_files = 'test_multifaults_subtb.i'
        execute_on = 'TIMESTEP_BEGIN'
    [../]
[]

[Transfers]
    [pull_resid]
        type = MultiAppCopyTransfer
        from_multi_app = sub_app
        source_variable = 'resid_sub_x resid_sub_y'
        variable = 'resid_x resid_y'
        execute_on = 'TIMESTEP_BEGIN'
    []
    [push_disp]
        type = MultiAppCopyTransfer
        to_multi_app = sub_app
        source_variable = 'disp_x disp_y'
        variable = 'disp_sub_x disp_sub_y'
        execute_on = 'TIMESTEP_BEGIN'
    []
[]

[BCs]
    [./dashpot_top_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_top_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_bottom_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_bottom_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_left_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_left_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_right_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
    [./dashpot_right_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
[]