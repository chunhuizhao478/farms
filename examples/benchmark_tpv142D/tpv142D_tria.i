# Verification of Benchmark Problem TPV205-2D from the SCEC Dynamic Rupture Validation exercises #
# Reference: #
# Harris, R. M.-P.-A. (2009). The SCEC/USGS Dynamic Earthquake Rupture Code Verification Exercise. Seismological Research Letters, vol. 80, no. 1, pages 119-126. #
# [Note]: This serves as a test file, to run the full problem, please extend the domain size by modifying nx, ny, xmin, xmax, ymin, ymax

[Mesh]
    [./msh]
      type = FileMeshGenerator
      file = '../../meshgenerator/tpv142d/tpv142d_100m.msh'
    []
    [./subdomain_id] # copy from the outputs of meshio_run_tria.py
      input = msh
      type = SubdomainPerElementGenerator 
      element_ids = '
      20 34 35 38 42 77 100 102 135 242 251 319 332 337 339 341 354 355 370 373 378 384 393 395 397 422 427 450 453 462 468 471 495 504 513 554 555 621 650 669 718 818 844 1159 1221 1275 1328 1392 1476 1555 1622 1646 1837 1921 2026 2231 2864 3036 3156 3173 3234 3378 3420 3622 3677 3939 3994 4057 4075 4188 4238 4363 4431 4475 4487 4508 4687 4740 4770 4847 4852 4877 4931 5027 5060 5067 5081 5082 5085 5098 5127 5193 5266 5267 5298 5357 5385 5391 5401 5468 5471 5475 5487 5588 5661 5664 5829 5869 5916 5918 5967 5996 5999 6009 6084 6160 6177 6278 6356 6448 6531 6574 6789 6959 7016 7075 7161 7216 7264 7334 7373 7400 7405 7494 7539 7610 7664 7668 7781 7979 8004 8110 8290 8420 8483 8593 8679 8741 8755 8838 8958 9002 9083 9304 9441 9451 9472 9516 9628 9665 9802 9943 10017 10041 10233 10507 10702 11062 11296 11692 11750 11762 12133 12716 13134 13450 13881 14396 15141 15400 16297 17417 17907 18343 19370 19869 20939 21761 22256 32205 430959 439048 441632 444099 444403 445376 445486 446623 447284 448038 448100 448389 449074 449468 450036 450551 450914 451031 451060 451158 451367 451542 451600 451687 451725 452040 452182 452340 452658 452867 453121 453301 453383 453565 453728 453934 454096 454178 454257 454327 454463 454566 454612 454692 454879 454893 455141 455158 455378 455554 455581 455603 455733 455934 456004 456067 456087 456243 456381 456431 456475 456563 456580 456718 456779 456782 456897 456925 456962 457047 457116 457300 457325 457374 457397 457402 457464 457493 457523 457551 457628 457645 457689 457720 457729 457778 457797 457840 457865 457910 457929 457985 458007 458051 458071 458098 458120 458160 458176 458225 458230 458234 458284 458307 458374 458375 458428 458456 458504 458528 458584 458596 458634 458710 458726 458729 458737 458739 458813 458861 458889 458891 458930 458952 458991 458995 459011 459026 459053 459108 459109 459112 459180 459210 459255 459271 459334 459355 459371 459421 459440 459498 459501 459508 459554 459590 459657 459734 459778 459846 459891 459919 459961 460031 460101 460146 460183 460210 460216 460255 460280 460283 460301 460303 460304 460307 460308 460311 460315 460319 460322 460325 460327 460329 460330 460334 460336 460337 460338 460339 460343 460345 460348 460349 460354 460355 460358 460359 460368 460371 460375 460376 460381 460384 460388 460389 460393 460397 460400 460401 460404 460406 460407 460409 460410 460415 460420 460423 460424 460427 460429 460430 460431 460436 460439 460441 460442 460446 460448 460449 460450 460453 460456 460458 460459 460463 460465 460467 460468 460471 460474 460476 460477 460478 460481 460482 460483 460484 460485 460486 460488 460489 460492 460493 460494 460495 460496 460497 460498 460499 460500 460501 460502 460503 460504 460505 460510 460511 460512 460513 460514 460515 460517 460518 460521 460522 460524 460526 460527 460528 460538 460581 460629 460686 460737 460739 460740 460741 460744 460745 460748 460750 460753 460754 460758 460761 460764 460766 460770 460771 460772 460773 460774 460779 460781 460784 460785 460789 460790 460792 460796 460797 460799 460802 460804 460807 460810 460813 460816 460822 460823 460825 460829 460831 460832 460851 460878 460884 460890 460915 460953 460997 461046 461156 461161 461163 461166 461168 461169 461177 461262 461272 461345 461348 461351 461352 461375 461381 461457 461664 461701 461708 461714 462077 462121 462195 462239 462259 462274 462279 462303 462306 462310 462313 462317 462326 462376 462429 462468 462495 462507 462520 462525 462528 462529 462539 462595 462608 462665 462746 462933 463037 463071 463098 463116 463124 463138 463146 261 957 1188 1453 1678 1873 2354 2376 2386 2388 2391 2392 2394 2395 2398 2399 2401 2402 2405 2406 2410 2411 2417 2418 2422 2423 2425 2426 2429 2431 2434 2464 2466 2470 2471 2477 2478 2480 2483 2487 2488 2491 2492 2493 2494 2499 2501 2504 2505 2509 2511 2514 2515 2517 2518 2521 2522 2525 2527 2530 2532 2533 2534 2535 2536 2538 2539 2542 2543 2546 2547 2549 2550 2556 2557 2558 2560 2561 2563 2567 2568 2572 2574 2576 2577 2583 2584 2588 2589 2595 2597 2601 2602 2605 2607 2610 2611 2615 2616 2618 2619 2626 2627 2637 2639 2642 2643 2645 2648 2649 2652 2653 2655 2656 2660 2661 2664 2665 2667 2670 2675 2676 2677 2681 2682 2683 2684 2686 2687 2695 2697 2701 2702 2705 2706 2709 2711 2714 2716 2719 2722 2725 2727 2730 2731 2733 2734 2737 2738 2740 2741 2742 2744 2745 2749 2750 2755 2756 2762 2765 2769 2771 2775 2776 2779 2780 2783 2784 2788 2789 2793 2794 2798 2799 2802 2803 2808 2809 2813 2814 2817 2819 2821 2823 2826 2827 2829 2830 2836 2839 2840 2843 2847 2848 2853 2854 2858 2859 2862 2863 2869 2870 2872 2873 2882 2883 2885 2886 2887 2892 2895 2897 2899 2901 2902 2908 2909 2914 2916 2918 2921 2922 2926 2928 2936 2938 2948 2950 2953 2954 2955 2957 2959 2960 2963 2965 2969 2972 2973 2975 2977 2979 2981 2982 2988 2989 2991 2992 2999 3000 3005 3006 3012 3014 3020 3022 3023 3028 3029 3033 3046 3052 3087 3095 3096 3097 3098 3101 3102 3105 3106 3109 3110 3113 3114 3117 3118 3124 3126 3129 3130 3134 3135 3137 3138 3144 3145 3147 3149 3150 3151 3157 3158 3164 3165 3168 3169 3175 3178 3181 3182 3188 3190 3196 3232 3243 3666 4334 6189 6191 6197 6198 6203 6205 6210 6214 6219 6220 6226 6227 6234 6236 6242 6243 6249 6250 6259 6260 6265 6269 6282 6283 6292 6294 6302 6305 6307 6308 6315 6317 6324 6325 6331 6332 6335 6337 6340 6341 6352 6354 6362 6365 6374 6376 6381 6384 6393 6396 6405 6410 6413 6415 6440 6442 6455 6457 6458 6459 6461 6465 6470 6473 6475 6477 6484 6485 6489 6491 6510 6512 6520 6523 6534 6536 6547 6548 6558 6561 6572 6573 6579 6581 6589 6590 6596 6598 6601 6604 6616 6617 6624 6625 6636 6637 6643 6647 6653 6655 6662 6665 6676 6679 6688 6689 6696 6698 6709 6710 6717 6718 6732 6734 6747 6748 6758 6763 6778 6780 6793 6797 6807 6810 6817 6819 6825 6826 6838 6839 6848 6849 6861 6864 6876 6880 6886 6888 6906 6909 6921 6923 6933 6937 6947 6948 6960 6962 6974 6977 6983 6986 6998 7000 7018 7019 7023 7025 7041 7043 7055 7058 7060 7062 7072 7073 7083 7085 7092 7094 7100 7101 7110 7111 7114 7117 7126 7127 7134 7137 7144 7146 7484 9027 17498 133690 139291 144787 147905 161474 164059 166995 177106 177555 178191 178994 450040 455659 455665 455672 455693 455705 455709 455716 455719 455724 455785 455786 455795 455796 455803 455804 455812 456095 456507 457264 457524 457532 460177 460192 460588 460590 460593 460604 460606 460609 460612 460616 460619 460622 460627 460628 460630 460634 460643 460644 460647 460657 460658 460661 460669 460746 460756 460769 460782 460801 460812 460859 461127 461129 461791 462660 462709 463033 463110 463112 463134 463189 
      111 371 424 594 663 702 717 851 860 876 1143 1189 1191 1401 1521 1535 1568 1722 1756 1785 1913 1943 1972 2098 2244 2335 2336 2364 2390 2447 2448 2482 2650 2699 2856 2888 3053 3064 3081 3094 3222 3293 3314 3327 3354 3377 3397 3484 3504 3518 3588 3635 3649 3682 3694 3696 3701 3832 3846 3981 4011 4020 4052 4056 4084 4115 4121 4199 4200 4278 4325 4699 4759 4762 4786 4914 5207 5235 5259 5293 5642 5701 6008 6068 6385 6535 7024 7265 7482 8173 8199 8579 9097 9283 9287 9639 10141 10550 10585 10689 10705 11042 11247 11301 11878 12760 13203 13274 13426 14196 14322 14398 16687 20149 20449 31082 35159 58935 72198 146321 260644 260879 261709 264620 265718 266053 266354 268400 268715 269061 269423 272778 274469 274880 275142 275192 277600 277954 278315 283408 298575 436794 437574 445444 446573 446916 447359 447933 450393 450591 450723 450936 451357 451627 452605 453125 453187 453564 454458 454852 455022 455062 455592 455595 455835 455884 456017 456029 456034 456070 456151 456169 456301 456334 456484 456506 456554 456663 457099 457178 457235 457275 457289 457668 457701 457844 457857 457884 458255 458283 458297 458390 458411 458469 458484 458547 458604 458746 458762 458862 458894 458908 459000 459157 459203 459224 459311 459428 459491 459574 459714 459788 459853 459912 460040 460041 460199 460223 460245 460290 460383 460385 460530 460568 460614 460695 460786 460791 460811 460841 460853 460930 461128 461152 461206 461259 461303 461315 461362 461384 461437 461535 461561 461727 461825 462412 462632 463117 95 98 147 226 229 234 252 289 292 333 356 359 432 460 528 539 552 587 598 639 826 1129 1130 1205 1234 1407 1445 1468 1560 1607 1636 1658 1769 1909 1947 2059 2150 2415 2587 2663 2715 2796 2898 2996 3286 3323 3324 3328 3395 3438 3516 3535 3626 3772 3831 3921 3927 3941 4051 4128 4263 4268 4320 4953 5048 5076 5150 5181 5327 5414 5990 6042 6144 6232 6334 6403 6444 6597 6602 6650 6975 7067 7125 7297 7341 7359 7555 7792 7838 8444 8684 9066 9326 9357 9680 9745 9818 9936 10076 10601 11047 11232 11745 12222 12327 13310 13367 13446 13679 14158 14168 14269 19270 24456 25722 29294 33468 45725 57976 162667 241079 241403 241559 241728 242449 242582 245447 246290 246712 247093 251074 251612 257357 257741 266180 445433 446150 446565 446850 447625 448027 448321 450035 450829 451213 451406 451695 451717 451736 451839 452172 452970 453090 453484 453793 454359 454397 454493 454504 454843 455248 455263 455330 455377 455416 455496 455652 455722 456088 456091 456110 456120 456132 456195 456218 456252 456433 456630 456737 457166 457173 457205 457578 457753 457954 458009 458028 458049 458086 458139 458173 458303 458333 458355 458461 458513 458717 458877 458905 458917 458919 459048 459078 459138 459204 459229 459290 459358 459387 459462 459595 459660 459700 459728 459896 459899 460011 460098 460148 460152 460173 460187 460194 460209 460219 460390 460434 460549 460663 460765 460897 460898 460910 460947 461073 461195 461225 461229 461231 461289 461339 461364 461406 461416 461422 461456 461594 461928 461947 462267 462452 462551 462895 462951 463085 463180 463188
      '
      subdomain_ids = '
      100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 
      300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400
      '
    []
    [./split]
      type = BreakMeshByBlockGenerator
      input = subdomain_id
      split_interface = true
      block_pairs = '100 200'
    []
    [./sidesets]
      input = split
      type = SideSetsFromNormalsGenerator
      normals = '-1 0 0
                  1 0 0
                  0 -1 0
                  0 1 0'
      new_boundary = 'left right bottom top'
    []  
  []

  [GlobalParams]
    #primary variables
    displacements = 'disp_x disp_y'
    #damping ratio
    q = 0.2
    #characteristic length (m)
    Dc = 0.4
    #initial normal stress (Pa)
    T2_o = 120e6
    #dynamic friction coefficient
    mu_d = 0.525
    #element edge length (m)
    len = 100
  []

  [AuxVariables]
    [./resid_x]
      order = FIRST
      family = LAGRANGE
    [../]
    [./resid_y]
        order = FIRST
        family = LAGRANGE
    []
    [./resid_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    [../]
    [./resid_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    [../]
    [./disp_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    []
    [./disp_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    [./vel_slipweakening_x]
      order = FIRST
      family = LAGRANGE
    []
    [./vel_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    [./mu_s]
        order = CONSTANT
        family = MONOMIAL
    []
    [./ini_shear_stress]
        order = CONSTANT
        family = MONOMIAL
    []
    [./jump_x_rate]
        order = CONSTANT
        family = MONOMIAL
    []
  []

  [Physics/SolidMechanics/CohesiveZone]
    [./czm_ik]
      boundary = 'Block100_Block200'
      strain = SMALL
      generate_output='traction_x traction_y jump_x jump_y'
    [../]
  []

  [Physics]
    [SolidMechanics]
      [QuasiStatic]
        [all]
          strain = SMALL
          add_variables = true
          planar_formulation = PLANE_STRAIN
          generate_output = 'stress_xx stress_yy stress_xy'
          extra_vector_tags = 'restore_tag'
        []
      []
    []
  []

  [Problem]
    extra_tag_vectors = 'restore_tag'
  []

  [Functions]
    [func_static_friction_coeff_mus]
      type = ConstantFunction
      value = 0.677
    []
    [func_initial_strike_shear_stress]
      type = PiecewiseConstant
      axis=x
      x = '-1000e3 -1.5e3  1.5e3'
      y = ' 70.0e6 81.6e6 70.0e6'
    []
  []

  [AuxKernels]
    [Displacment_x]
      type = ProjectionAux
      variable = disp_slipweakening_x
      v = disp_x
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Displacement_y]
      type = ProjectionAux
      variable = disp_slipweakening_y
      v = disp_y
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Vel_x]
      type = CompVarRate
      variable = vel_slipweakening_x
      coupled = disp_x
      execute_on = 'TIMESTEP_END'
    []
    [Vel_y]
      type = CompVarRate
      variable = vel_slipweakening_y
      coupled = disp_y
      execute_on = 'TIMESTEP_END'
    []
    [jump_x_rate]
      type = FDCompVarRate
      variable = jump_x_rate
      coupled = jump_x
      execute_on = 'TIMESTEP_END'
    []
    [Residual_x]
      type = ProjectionAux
      variable = resid_slipweakening_x
      v = resid_x
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Residual_y]
      type = ProjectionAux
      variable = resid_slipweakening_y
      v = resid_y
      execute_on = 'TIMESTEP_BEGIN'
    []
    [restore_x]
      type = TagVectorAux
      vector_tag = 'restore_tag'
      v = 'disp_x'
      variable = 'resid_x'
      execute_on = 'TIMESTEP_END'
    []
    [restore_y]
      type = TagVectorAux
      vector_tag = 'restore_tag'
      v = 'disp_y'
      variable = 'resid_y'
      execute_on = 'TIMESTEP_END'
    []
    [StaticFricCoeff]
      type = FunctionAux
      variable = mu_s
      function = func_static_friction_coeff_mus
      execute_on = 'LINEAR TIMESTEP_BEGIN'
    []
    [StrikeShearStress]
      type = FunctionAux
      variable = ini_shear_stress
      function = func_initial_strike_shear_stress
      execute_on = 'LINEAR TIMESTEP_BEGIN'
    []
  []

  [Kernels]
    [./inertia_x]
      type = InertialForce
      use_displaced_mesh = false
      variable = disp_x
    []
    [./inertia_y]
      type = InertialForce
      use_displaced_mesh = false
      variable = disp_y
    []
    [./Reactionx]
      type = StiffPropDamping
      variable = 'disp_x'
      component = '0'
    []
    [./Reactiony]
      type = StiffPropDamping
      variable = 'disp_y'
      component = '1'
    []
  []

  [Materials]
    [elasticity]
        type = ComputeIsotropicElasticityTensor
        lambda = 32.04e9
        shear_modulus = 32.04e9
        use_displaced_mesh = false
    []
    [stress]
        type = ComputeLinearElasticStress
    []
    [density]
        type = GenericConstantMaterial
        prop_names = density
        prop_values = 2670
    []
    [./czm_mat]
        type = SlipWeakeningFrictionczm2d
        disp_slipweakening_x     = disp_slipweakening_x
        disp_slipweakening_y     = disp_slipweakening_y
        reaction_slipweakening_x = resid_slipweakening_x
        reaction_slipweakening_y = resid_slipweakening_y
        mu_s = mu_s
        ini_shear_sts = ini_shear_stress
        boundary = 'Block100_Block200'
    [../]
  []

  [UserObjects]
    [recompute_residual_tag]
        type = ResidualEvaluationUserObject
        vector_tag = 'restore_tag'
        force_preaux = true
        execute_on = 'TIMESTEP_END'
    []
  []

  [Executioner]
    type = Transient
    dt = 0.0025
    end_time = 12
    # num_steps = 10
    [TimeIntegrator]
      type = CentralDifference
      solve_type = lumped
    []
  []

  [Outputs]
    exodus = true
    time_step_interval = 40
  []

  [BCs]
    [./dashpot_top_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_top_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_bottom_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_bottom_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_left_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_left_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_right_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
    [./dashpot_right_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
  []

