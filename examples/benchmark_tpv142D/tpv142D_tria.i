# Verification of Benchmark Problem TPV205-2D from the SCEC Dynamic Rupture Validation exercises #
# Reference: #
# Harris, R. M.-P.-A. (2009). The SCEC/USGS Dynamic Earthquake Rupture Code Verification Exercise. Seismological Research Letters, vol. 80, no. 1, pages 119-126. #
# [Note]: This serves as a test file, to run the full problem, please extend the domain size by modifying nx, ny, xmin, xmax, ymin, ymax

[Mesh]
    [./msh]
      type = FileMeshGenerator
      file = '../../meshgenerator/tpv142d/tpv142d_100m.msh'
    []
    [./subdomain_id] # copy from the outputs of meshio_run_tria.py
      input = msh
      type = SubdomainPerElementGenerator 
      element_ids = '
      27 41 273 353 356 471 603 634 641 725 974 985 1102 1220 1243 1317 1501 1718 1803 1876 1918 1943 2202 2349 2367 2415 2463 2492 2658 2841 2926 2930 2944 3000 3048 3050 3226 3285 3310 3387 3493 3512 3791 3977 4007 4067 4083 4279 4312 4381 4588 4615 4642 4777 4812 4824 4863 4864 4876 4879 4893 4945 4962 4986 5013 5032 5073 5083 5086 5132 5143 5161 5168 5182 5193 5231 5233 5301 5327 5351 5354 5361 5394 5502 5576 5619 5638 5744 5782 5844 5949 6006 6064 6148 6189 6352 6365 6437 6533 6545 6609 6680 6750 6804 6885 7009 7064 7121 7230 7484 7533 7585 7601 7659 7860 7980 8041 8049 8090 8097 8247 8456 8512 8703 8846 8906 8953 9173 9234 9420 9441 9575 9635 9641 9676 9726 9795 9990 9992 10003 10112 10175 10193 10263 10459 10508 10630 10910 10988 11003 11007 11023 11137 11264 11318 11540 11565 11818 11832 11853 12105 12148 12279 12414 12665 12672 12912 13010 13054 13214 13655 13661 13993 14033 14053 14691 14700 15042 15096 15842 15847 16133 16269 16347 17169 17173 17726 17815 18928 18941 19564 19645 20905 20918 21750 21871 23690 23729 25000 25267 25836 26222 28250 28306 29123 29607 30581 31195 31295 31337 31678 32103 32474 32929 34101 34206 34318 34383 34898 34905 35196 35658 35772 36367 37078 37206 37630 38384 38854 38973 39211 40216 40309 40524 40633 40674 41163 41240 41547 42283 42614 42816 43152 43654 43723 44290 45104 45237 45414 45981 46265 46434 46877 46911 47261 47374 47723 48066 48173 48431 48788 49087 49097 49107 49566 50029 50078 50148 51424 52652 53530 53736 54127 55874 55922 56349 56443 56714 57997 58193 58441 58678 59153 59637 59875 60182 60859 61519 61916 62051 62495 63675 64464 65517 66421 66444 67486 68714 68817 68895 70292 71801 72794 73439 73958 74423 74531 74641 74940 75475 76095 76163 76701 77349 78255 78659 79340 79959 80535 81613 82405 83084 83994 84973 87038 87918 88505 88542 89141 89304 89854 92596 93583 95916 362380 379462 414103 415692 424505 427389 427512 430849 431213 434940 435071 436943 437002 437071 439300 439424 440680 440779 441655 442494 442523 442637 443472 443498 444958 445064 445627 445887 445888 446084 447161 447319 447845 447986 448041 449016 449703 449767 450018 450361 450723 451545 451893 452384 452868 452960 453448 453579 453801 453829 454538 454580 454617 454742 455157 455954 456111 456371 456384 456485 456572 456738 456807 456891 456944 457102 457116 457270 457446 457450 457606 457731 457799 457996 458136 458225 458376 458426 458596 458805 458846 459008 459129 459160 459355 459487 459522 459744 459765 459863 460035 460043 460090 460170 460327 460367 460481 460663 460683 460853 460938 461047 461154 462122 462975 464081 464182 464282 464409 464568 464705 464806 464895 465020 465085 465105 465218 465310 465425 465452 465467 465485 465548 465698 465863 465980 466199 466736 467276 467407 467408 467409 467422 467426 467438 467439 467454 467495 467542 467702 467840 468070 468564 468575 468667 468719 468739 468750 468794 468801 468802 468807 468811 468816 468818 468824 468908 469078 469083 469092 469094 469096 469102 469105 469107 469113 469127 469129 469132 469134 469135 469138 469140 469141 469144 469145 469146 469151 469154 469155 469159 469162 469164 469166 469171 469173 469174 469175 469177 469181 469182 469183 469186 469187 469188 469190 469191 469192 469193 469196 469197 469198 469203 469205 469206 469207 469209 469210 469211 469214 469222 469223 469224 469227 469229 469230 469235 469237 469239 469240 469243 469245 469246 469248 469252 469256 469456 469586 469815 470097 470117 869 1203 1612 1917 2218 2639 4607 7001 7002 7012 7013 7019 7021 7026 7027 7032 7035 7040 7042 7049 7050 7052 7054 7060 7061 7065 7066 7067 7070 7075 7076 7081 7083 7087 7088 7093 7096 7100 7103 7105 7107 7110 7111 7119 7120 7129 7130 7135 7136 7142 7143 7147 7148 7153 7154 7158 7160 7165 7166 7175 7176 7182 7184 7194 7195 7200 7201 7204 7206 7216 7218 7223 7224 7226 7228 7234 7235 7240 7241 7246 7249 7252 7256 7262 7266 7268 7269 7273 7277 7281 7282 7287 7288 7289 7295 7297 7301 7303 7311 7313 7315 7317 7324 7325 7326 7327 7338 7339 7345 7346 7348 7350 7356 7357 7360 7361 7369 7370 7375 7378 8198 8201 8507 8573 8785 9128 9143 9156 9158 9161 9179 9217 9325 9367 9395 9444 9545 9570 9599 9781 9824 9855 10215 10229 10236 10260 10289 10321 10418 10586 10648 10653 10682 10683 10692 10710 10762 10809 10811 10844 10880 10884 10914 11015 11067 11075 11109 11123 11149 11209 11244 11326 11330 11652 11712 11897 11908 11946 11959 12028 12734 12810 13504 13512 13523 13530 13534 13557 13558 13563 13581 13594 13600 13602 13613 13637 13658 13671 13688 13703 13719 13724 13731 13746 13761 13779 13789 13807 13819 13840 13854 13874 13888 13906 13917 13931 13939 13960 13978 13987 14006 14025 14040 14063 14076 14092 14102 14122 14131 14141 14149 14162 14173 14190 14208 14223 14237 14239 14256 14270 14283 14293 14309 14324 14336 14347 14368 14388 14398 14409 14421 14426 14434 14448 14471 14484 14508 14520 14533 14549 14574 14582 14608 14625 14643 14654 14675 14689 14707 14719 14731 14741 14761 14776 14798 14810 14830 14843 14864 14878 14888 14902 14919 14934 14946 14947 14962 14973 14994 15009 15030 15048 15062 15076 15100 15126 15151 15168 15188 15208 15223 15244 15257 15277 15295 15318 15330 15345 15360 15377 15388 15403 15417 15438 15454 15469 15484 15507 15514 15534 15548 15566 15586 15609 15620 15642 15657 15678 15693 15706 15721 15726 15749 15767 15792 15811 15841 15857 15886 15902 15917 15929 15938 15944 15958 15975 15988 16013 16035 16056 16075 16102 16118 16145 16165 16187 16203 16223 16240 16255 16272 16302 16322 16351 16365 16383 16398 16412 16429 16447 16456 16483 16497 16520 16545 16573 16590 16611 16630 16657 16669 16686 16705 16724 16729 16747 16770 16789 16799 16815 16836 16845 16867 16886 16889 16908 16931 16958 16980 17004 17029 17056 17085 17105 17123 17143 17164 17184 17205 17230 17241 17264 17275 17301 17320 17353 17378 17419 17452 17458 17484 17506 17535 17555 17574 17595 17605 17636 17653 17679 17698 17736 17751 17787 17814 17845 17873 17907 17929 17958 17989 18023 18048 18079 18097 18133 18150 18177 18178 18201 18227 18243 18273 18294 18323 18348 18379 18385 18398 18424 18440 18478 18509 18541 18560 18583 18607 18640 18662 18695 18716 18753 18786 18828 18847 18882 18901 18931 18956 18986 19011 19040 19062 19071 19094 19117 19158 19180 19217 19242 19267 19292 19323 19354 19385 19413 19444 19467 19498 19517 19549 19565 19596 19613 19640 19663 19688 19715 19739 19756 19804 19863 19977 20152 20850 21122 21373 30752 32020 40221 180003 182849 200298 202338 203657 205583 330580 346125 369604 373573 384805 390221 390222 399437 399439 403483 405178 410328 415212 415940 416539 417308 417974 418475 418995 424203 431067 439539 445178 452373 453168 453174 453742 455941 460272 462580 463791 464082 464698 464700 464701 468465 470331
      114 278 435 1674 1850 2249 2338 2368 2506 2638 2928 3105 3306 3390 3907 4490 4638 4782 4787 4978 5288 5338 5625 5818 6210 6212 6219 6281 6300 6526 6790 6860 7008 7018 7114 7140 7367 7480 7597 7745 7764 7801 7865 8154 8472 8844 8958 9178 9190 10055 10994 11159 11332 12097 12592 15182 15999 16081 16959 17542 18420 18551 18743 18788 18972 19666 20039 20232 21109 22402 22582 26294 26376 27141 29011 29565 29682 30775 32501 143012 145130 148650 148681 151490 152167 153401 154138 155547 156948 157361 159186 159787 159928 161217 161974 162047 163159 164072 164200 164737 165332 166480 166491 167651 168028 168869 169453 170146 172824 175041 179311 182247 185308 188891 189872 209998 233686 236803 238847 244600 248695 255840 423723 425494 426697 427334 431070 434995 442927 443115 443324 444442 445400 446268 447787 447847 448505 448973 449068 449099 449811 450473 450915 451096 451271 451682 452025 452178 452277 452348 452360 452570 452599 452696 452705 452736 452912 452917 453054 453057 453058 453310 453345 453741 453795 453944 453974 454572 454660 454693 454873 454977 456047 457208 457348 457385 457581 458094 458387 458516 458804 458868 458910 458966 459011 459391 459451 459590 459933 460066 460079 460182 460368 460414 460677 461022 461187 461278 461300 461374 461668 461741 461754 461902 461991 462159 462272 462472 462473 462491 462503 462635 462689 463124 463134 463391 463480 463546 463611 463697 463765 463778 463809 463930 463966 463993 464018 464085 464119 464254 464318 464325 464385 464483 464526 464553 464560 464687 464708 464740 464756 464827 464857 465405 466144 466345 466773 467101 467198 385 414 514 1263 1266 1431 1445 1832 1896 2049 2051 2327 2388 2466 2485 2512 2704 2947 3178 3247 3538 3679 3870 4058 4129 4224 4319 4405 4430 4628 4764 4997 5279 5299 5316 5388 5466 5477 5648 6089 6166 6428 6434 7071 7428 7502 7583 7838 8337 9265 9924 10367 10426 10515 11156 12388 12482 13065 15757 16683 19067 19200 19459 19716 20448 20722 20911 22606 24006 25490 25991 27226 28141 30432 32900 38160 45455 65947 80926 81557 89184 92876 94152 97410 97678 98883 102235 106162 113183 115463 116134 116435 117628 117659 117773 119998 121336 121405 122024 122628 123768 123944 124066 124308 126124 126480 127305 130622 135973 143852 143871 147452 149771 150493 151186 153028 153362 155555 155837 156017 157660 157994 158571 158911 159452 160505 161292 162325 167276 167721 168221 171467 171845 173709 173782 174266 176943 181433 182732 183176 183304 183894 185169 185455 186878 187035 187514 188139 188617 189241 189744 190267 194776 216600 245238 264942 431025 433583 434247 434561 436583 440079 441339 443305 447127 447636 447715 449023 451027 451492 451885 451886 452531 452746 452799 452891 452962 453137 453201 454990 455013 456595 456626 456861 457377 457397 457420 457528 457613 457624 457662 457728 457729 457769 457856 457919 457958 458121 458130 458243 458250 458480 458553 458573 459282 459482 459545 459859 459865 459945 460146 460173 460215 460373 460565 460652 461031 461233 461380 461479 461569 461808 461967 462046 462258 462315 462320 462375 462516 462680 462961 463007 463212 463329 463346 463377 463458 463667 463704 463857 464185 464350 464397 464642 464726 466790 467595 469890
      '
      subdomain_ids = '
      100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 200 
      300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 300 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400 400
      '
    []
    [./split]
      type = BreakMeshByBlockGenerator
      input = subdomain_id
      split_interface = true
      block_pairs = '100 200; 300 400'
    []
    [./sidesets]
      input = split
      type = SideSetsFromNormalsGenerator
      normals = '-1 0 0
                  1 0 0
                  0 -1 0
                  0 1 0'
      new_boundary = 'left right bottom top'
    []  
  []

  [GlobalParams]
    #primary variables
    displacements = 'disp_x disp_y'
    #damping ratio
    q = 0.1
    #characteristic length (m)
    Dc = 0.4
    #initial normal stress (Pa)
    T2_o = 120e6
    #dynamic friction coefficient
    mu_d = 0.525
    #element edge length (m)
    len = 100
  []

  [AuxVariables]
    [./resid_x]
      order = FIRST
      family = LAGRANGE
    [../]
    [./resid_y]
        order = FIRST
        family = LAGRANGE
    []
    [./resid_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    [../]
    [./resid_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    [../]
    [./disp_slipweakening_x]
        order = FIRST
        family = LAGRANGE
    []
    [./disp_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    [./vel_slipweakening_x]
      order = FIRST
      family = LAGRANGE
    []
    [./vel_slipweakening_y]
        order = FIRST
        family = LAGRANGE
    []
    [./mu_s]
        order = CONSTANT
        family = MONOMIAL
    []
    [./ini_shear_stress]
        order = CONSTANT
        family = MONOMIAL
    []
    [./shear_jump_rate_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./shear_jump_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./normal_jump_aux]
      order = CONSTANT
      family = MONOMIAL
  []
    [./shear_traction_aux]
        order = CONSTANT
        family = MONOMIAL
    []
    [./normal_traction_aux]
      order = CONSTANT
      family = MONOMIAL
    []
  []

  [Physics/SolidMechanics/CohesiveZone]
    [./czm_ik]
      boundary = 'Block100_Block200 Block300_Block400'
      strain = SMALL
      generate_output='traction_x traction_y jump_x jump_y'
    [../]
  []

  [Physics]
    [SolidMechanics]
      [QuasiStatic]
        [all]
          strain = SMALL
          add_variables = true
          planar_formulation = PLANE_STRAIN
          generate_output = 'stress_xx stress_yy stress_xy'
          extra_vector_tags = 'restore_tag'
        []
      []
    []
  []

  [Problem]
    extra_tag_vectors = 'restore_tag'
  []

  [Functions]
    [func_static_friction_coeff_mus]
      type = ConstantFunction
      value = 0.677
    []
    #the center is (-8000,0)
    #expand 1.5e3 on both side (-9500,0) and (-6500,0)
    [func_initial_strike_shear_stress]
      type = PiecewiseConstant
      axis=x
      x = '-1000e3 -9.5e3  -6.5e3'
      y = ' 70.0e6 81.6e6 70.0e6'
    []
  []

  [AuxKernels]
    [Displacment_x]
      type = ProjectionAux
      variable = disp_slipweakening_x
      v = disp_x
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Displacement_y]
      type = ProjectionAux
      variable = disp_slipweakening_y
      v = disp_y
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Vel_x]
      type = CompVarRate
      variable = vel_slipweakening_x
      coupled = disp_x
      execute_on = 'TIMESTEP_END'
    []
    [Vel_y]
      type = CompVarRate
      variable = vel_slipweakening_y
      coupled = disp_y
      execute_on = 'TIMESTEP_END'
    []
    [jump_x_rate]
      type = FDCompVarRate
      variable = shear_jump_rate_aux
      coupled = jump_x
      execute_on = 'TIMESTEP_END'
    []
    [Residual_x]
      type = ProjectionAux
      variable = resid_slipweakening_x
      v = resid_x
      execute_on = 'TIMESTEP_BEGIN'
    []
    [Residual_y]
      type = ProjectionAux
      variable = resid_slipweakening_y
      v = resid_y
      execute_on = 'TIMESTEP_BEGIN'
    []
    [restore_x]
      type = TagVectorAux
      vector_tag = 'restore_tag'
      v = 'disp_x'
      variable = 'resid_x'
      execute_on = 'TIMESTEP_END'
    []
    [restore_y]
      type = TagVectorAux
      vector_tag = 'restore_tag'
      v = 'disp_y'
      variable = 'resid_y'
      execute_on = 'TIMESTEP_END'
    []
    [StaticFricCoeff]
      type = FunctionAux
      variable = mu_s
      function = func_static_friction_coeff_mus
      execute_on = 'LINEAR TIMESTEP_BEGIN'
    []
    [StrikeShearStress]
      type = FunctionAux
      variable = ini_shear_stress
      function = func_initial_strike_shear_stress
      execute_on = 'LINEAR TIMESTEP_BEGIN'
    []
    ##
    [GetJumpX]
      type = MaterialRealAux
      property = jump_x
      variable = shear_jump_aux
      boundary = 'Block100_Block200 Block300_Block400'
    []
    [GetJumpY]
      type = MaterialRealAux
      property = jump_y
      variable = normal_jump_aux
      boundary = 'Block100_Block200 Block300_Block400'
    []
    [GetTractionX]
      type = MaterialRealAux
      property = traction_x
      variable = shear_traction_aux
      boundary = 'Block100_Block200 Block300_Block400'
    []
  []

  [Kernels]
    [./inertia_x]
      type = InertialForce
      use_displaced_mesh = false
      variable = disp_x
    []
    [./inertia_y]
      type = InertialForce
      use_displaced_mesh = false
      variable = disp_y
    []
    [./Reactionx]
      type = StiffPropDamping
      variable = 'disp_x'
      component = '0'
    []
    [./Reactiony]
      type = StiffPropDamping
      variable = 'disp_y'
      component = '1'
    []
  []

  [Materials]
    [elasticity]
        type = ComputeIsotropicElasticityTensor
        lambda = 32.04e9
        shear_modulus = 32.04e9
        use_displaced_mesh = false
    []
    [stress]
        type = ComputeLinearElasticStress
    []
    [density]
        type = GenericConstantMaterial
        prop_names = density
        prop_values = 2670
    []
    [./czm_mat]
        type = SlipWeakeningFrictionczm2d
        disp_slipweakening_x     = disp_slipweakening_x
        disp_slipweakening_y     = disp_slipweakening_y
        reaction_slipweakening_x = resid_slipweakening_x
        reaction_slipweakening_y = resid_slipweakening_y
        mu_s = mu_s
        ini_shear_sts = ini_shear_stress
        boundary = 'Block100_Block200 Block300_Block400'
    [../]
    ##
    [./shear_jump_mat]
      type = ParsedMaterial
      property_name = shear_jump_mat
      coupled_variables = 'shear_jump_aux'
      expression = 'shear_jump_aux'
      outputs = exodus
    []
    [./normal_jump_mat]
      type = ParsedMaterial
      property_name = normal_jump_mat
      coupled_variables = 'normal_jump_aux'
      expression = 'normal_jump_aux'
      outputs = exodus
    []
    [./shear_traction_mat]
      type = ParsedMaterial
      property_name = shear_traction_mat
      coupled_variables = 'shear_traction_aux'
      expression = 'shear_traction_aux'
      outputs = exodus
    []
    [./shear_jump_rate_mat]
      type = ParsedMaterial
      property_name = shear_jump_rate_mat
      coupled_variables = 'shear_jump_rate_aux'
      expression = 'shear_jump_rate_aux'
      outputs = exodus
    []
  []

  [UserObjects]
    [recompute_residual_tag]
        type = ResidualEvaluationUserObject
        vector_tag = 'restore_tag'
        force_preaux = true
        execute_on = 'TIMESTEP_END'
    []
  []

  [Executioner]
    type = Transient
    dt = 0.0025
    end_time = 12
    # num_steps = 10
    [TimeIntegrator]
      type = CentralDifference
      solve_type = lumped
    []
  []

  [Outputs]
    exodus = true
    time_step_interval = 40
    # [csv]
    #   type = CSV
    #   execute_on = 'initial timestep_end'
    #   time_step_interval = 1
    # []
  []

  [BCs]
    [./dashpot_top_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_top_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = top
    []
    [./dashpot_bottom_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_bottom_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = bottom
    []
    [./dashpot_left_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_left_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = left
    []
    [./dashpot_right_x]
        type = NonReflectDashpotBC
        component = 0
        variable = disp_x
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
    [./dashpot_right_y]
        type = NonReflectDashpotBC
        component = 1
        variable = disp_y
        disp_x = disp_x
        disp_y = disp_y
        p_wave_speed = 6000
        shear_wave_speed = 3464
        boundary = right
    []
  []

  [VectorPostprocessors]
    [shear_jump_mat]
      type = ElementMaterialSampler
      material = 'shear_jump_mat'
      elem_ids = '5869 8838 5664 7668 9516 17417 5357 7610 11750 5127 5067 7539 9628 19869 4770 4687 8679 4475 9441 462303 462310 462317 462259 1275 555 513 468 453 427 397 378 339 354 461664 242 1622 42 462539 319 669 462520 462468 462376 462274 462195 461381 461046 460953 460829 460686 460581 460483 460337 460255 460183 460101 459961 459846 459734 459590 459440 459271 459112 458952 458813 458634 458456 458307 458176 458051 457929 457778 457628 457464 457300 456897 456563 456243 455934 455581 455158 454692 454327 453934 453565 453121 452658 452040 451542 450914 450036 449074 448038 446623 444403 439048 32205 18343 15400 13881 12716 11762 11062 10507 10017 9665 9304 8958 8593 8290 7979 7664 7405 7161 6789 6448 6177 6009 5829 5588 5391 5193 5027 4847 4363 4057 5385 4487 3234 2864 5967 4238 2026 1837 6531 3939 1328 1159 7334 3677 718 621 8004 3420 393 337 8755 3156 135 77 100 456087 455603 454879 454257 452182 451060 19370 11692 3994 20 818 460210 459919 461272 461177 459011 457397 461714 461708 459501 459421 459334 459210 459109 458995 458889 458739 458596 458428 458284 458160 458071 458007 457865 457720 457551 457402 457116 456782 456431 458930 460498 460496 460492 460488 462529 462525 460526 460524 460515 460511 460503 460504 462507 460517 460513 460505 460499 460495 460486 460485 460481 460478 460476 460471 460467 460463 460458 460453 460449 460446 460441 460436 460430 460427 460423 460415 460409 460404 460401 460393 460389 460381 460376 460368 460359 460354 460349 460343 460339 460334 460330 460327 460322 460315 460308 460304 460301 462279 460799 460807 460831 460825 460816 460813 460804 460797 460792 460785 460781 460774 460770 460772 460764 460761 460754 460750 460745 460740 460737 462121 461168 461169 461163 461156 462077 461351 461348 461345
      1189 461128 298575 461535 457289 4056 460199 1191 446916 459912 3846 461437 3484 4325 10141 451627 9097 4115 461259 4278 6385 2448 2447 461303 4020 9287 16687 58935 275142 274469 461362 3649 445444 453125 272778 460853 3694 461315 3081 455592 146321 31082 10585 3832 461152 269423 269061 268715 268400 461206 3701 8199 450393 450936 459000 3222 459853 3314 455884 266354 266053 265718 3518 460614 2482 457884 457099 264620 4084 1972 594 460841 461825 457857 2390 460568 3397 7265 447933 14322 5259 3094 459788 2856 458762 457235 261709 456169 3354 460811 2098 457275 455595 1785 460786 260644 460385 1401 1521 5235 2336 460223 3064 459574 702 14398 459311 2888 460040 2364 4052 6008 8173 452605 260879 460791 1756 2335 3981'
    []
    [normal_jump_mat]
      type = ElementMaterialSampler
      material = 'normal_jump_mat'
      elem_ids = '5869 8838 5664 7668 9516 17417 5357 7610 11750 5127 5067 7539 9628 19869 4770 4687 8679 4475 9441 462303 462310 462317 462259 1275 555 513 468 453 427 397 378 339 354 461664 242 1622 42 462539 319 669 462520 462468 462376 462274 462195 461381 461046 460953 460829 460686 460581 460483 460337 460255 460183 460101 459961 459846 459734 459590 459440 459271 459112 458952 458813 458634 458456 458307 458176 458051 457929 457778 457628 457464 457300 456897 456563 456243 455934 455581 455158 454692 454327 453934 453565 453121 452658 452040 451542 450914 450036 449074 448038 446623 444403 439048 32205 18343 15400 13881 12716 11762 11062 10507 10017 9665 9304 8958 8593 8290 7979 7664 7405 7161 6789 6448 6177 6009 5829 5588 5391 5193 5027 4847 4363 4057 5385 4487 3234 2864 5967 4238 2026 1837 6531 3939 1328 1159 7334 3677 718 621 8004 3420 393 337 8755 3156 135 77 100 456087 455603 454879 454257 452182 451060 19370 11692 3994 20 818 460210 459919 461272 461177 459011 457397 461714 461708 459501 459421 459334 459210 459109 458995 458889 458739 458596 458428 458284 458160 458071 458007 457865 457720 457551 457402 457116 456782 456431 458930 460498 460496 460492 460488 462529 462525 460526 460524 460515 460511 460503 460504 462507 460517 460513 460505 460499 460495 460486 460485 460481 460478 460476 460471 460467 460463 460458 460453 460449 460446 460441 460436 460430 460427 460423 460415 460409 460404 460401 460393 460389 460381 460376 460368 460359 460354 460349 460343 460339 460334 460330 460327 460322 460315 460308 460304 460301 462279 460799 460807 460831 460825 460816 460813 460804 460797 460792 460785 460781 460774 460770 460772 460764 460761 460754 460750 460745 460740 460737 462121 461168 461169 461163 461156 462077 461351 461348 461345
      1189 461128 298575 461535 457289 4056 460199 1191 446916 459912 3846 461437 3484 4325 10141 451627 9097 4115 461259 4278 6385 2448 2447 461303 4020 9287 16687 58935 275142 274469 461362 3649 445444 453125 272778 460853 3694 461315 3081 455592 146321 31082 10585 3832 461152 269423 269061 268715 268400 461206 3701 8199 450393 450936 459000 3222 459853 3314 455884 266354 266053 265718 3518 460614 2482 457884 457099 264620 4084 1972 594 460841 461825 457857 2390 460568 3397 7265 447933 14322 5259 3094 459788 2856 458762 457235 261709 456169 3354 460811 2098 457275 455595 1785 460786 260644 460385 1401 1521 5235 2336 460223 3064 459574 702 14398 459311 2888 460040 2364 4052 6008 8173 452605 260879 460791 1756 2335 3981'
    []
    [shear_traction_mat]
      type = ElementMaterialSampler
      material = 'shear_traction_mat'
      elem_ids = '5869 8838 5664 7668 9516 17417 5357 7610 11750 5127 5067 7539 9628 19869 4770 4687 8679 4475 9441 462303 462310 462317 462259 1275 555 513 468 453 427 397 378 339 354 461664 242 1622 42 462539 319 669 462520 462468 462376 462274 462195 461381 461046 460953 460829 460686 460581 460483 460337 460255 460183 460101 459961 459846 459734 459590 459440 459271 459112 458952 458813 458634 458456 458307 458176 458051 457929 457778 457628 457464 457300 456897 456563 456243 455934 455581 455158 454692 454327 453934 453565 453121 452658 452040 451542 450914 450036 449074 448038 446623 444403 439048 32205 18343 15400 13881 12716 11762 11062 10507 10017 9665 9304 8958 8593 8290 7979 7664 7405 7161 6789 6448 6177 6009 5829 5588 5391 5193 5027 4847 4363 4057 5385 4487 3234 2864 5967 4238 2026 1837 6531 3939 1328 1159 7334 3677 718 621 8004 3420 393 337 8755 3156 135 77 100 456087 455603 454879 454257 452182 451060 19370 11692 3994 20 818 460210 459919 461272 461177 459011 457397 461714 461708 459501 459421 459334 459210 459109 458995 458889 458739 458596 458428 458284 458160 458071 458007 457865 457720 457551 457402 457116 456782 456431 458930 460498 460496 460492 460488 462529 462525 460526 460524 460515 460511 460503 460504 462507 460517 460513 460505 460499 460495 460486 460485 460481 460478 460476 460471 460467 460463 460458 460453 460449 460446 460441 460436 460430 460427 460423 460415 460409 460404 460401 460393 460389 460381 460376 460368 460359 460354 460349 460343 460339 460334 460330 460327 460322 460315 460308 460304 460301 462279 460799 460807 460831 460825 460816 460813 460804 460797 460792 460785 460781 460774 460770 460772 460764 460761 460754 460750 460745 460740 460737 462121 461168 461169 461163 461156 462077 461351 461348 461345
      1189 461128 298575 461535 457289 4056 460199 1191 446916 459912 3846 461437 3484 4325 10141 451627 9097 4115 461259 4278 6385 2448 2447 461303 4020 9287 16687 58935 275142 274469 461362 3649 445444 453125 272778 460853 3694 461315 3081 455592 146321 31082 10585 3832 461152 269423 269061 268715 268400 461206 3701 8199 450393 450936 459000 3222 459853 3314 455884 266354 266053 265718 3518 460614 2482 457884 457099 264620 4084 1972 594 460841 461825 457857 2390 460568 3397 7265 447933 14322 5259 3094 459788 2856 458762 457235 261709 456169 3354 460811 2098 457275 455595 1785 460786 260644 460385 1401 1521 5235 2336 460223 3064 459574 702 14398 459311 2888 460040 2364 4052 6008 8173 452605 260879 460791 1756 2335 3981'
    []
    [shear_jump_rate_mat]
      type = ElementMaterialSampler
      material = 'shear_jump_rate_mat'
      elem_ids = '5869 8838 5664 7668 9516 17417 5357 7610 11750 5127 5067 7539 9628 19869 4770 4687 8679 4475 9441 462303 462310 462317 462259 1275 555 513 468 453 427 397 378 339 354 461664 242 1622 42 462539 319 669 462520 462468 462376 462274 462195 461381 461046 460953 460829 460686 460581 460483 460337 460255 460183 460101 459961 459846 459734 459590 459440 459271 459112 458952 458813 458634 458456 458307 458176 458051 457929 457778 457628 457464 457300 456897 456563 456243 455934 455581 455158 454692 454327 453934 453565 453121 452658 452040 451542 450914 450036 449074 448038 446623 444403 439048 32205 18343 15400 13881 12716 11762 11062 10507 10017 9665 9304 8958 8593 8290 7979 7664 7405 7161 6789 6448 6177 6009 5829 5588 5391 5193 5027 4847 4363 4057 5385 4487 3234 2864 5967 4238 2026 1837 6531 3939 1328 1159 7334 3677 718 621 8004 3420 393 337 8755 3156 135 77 100 456087 455603 454879 454257 452182 451060 19370 11692 3994 20 818 460210 459919 461272 461177 459011 457397 461714 461708 459501 459421 459334 459210 459109 458995 458889 458739 458596 458428 458284 458160 458071 458007 457865 457720 457551 457402 457116 456782 456431 458930 460498 460496 460492 460488 462529 462525 460526 460524 460515 460511 460503 460504 462507 460517 460513 460505 460499 460495 460486 460485 460481 460478 460476 460471 460467 460463 460458 460453 460449 460446 460441 460436 460430 460427 460423 460415 460409 460404 460401 460393 460389 460381 460376 460368 460359 460354 460349 460343 460339 460334 460330 460327 460322 460315 460308 460304 460301 462279 460799 460807 460831 460825 460816 460813 460804 460797 460792 460785 460781 460774 460770 460772 460764 460761 460754 460750 460745 460740 460737 462121 461168 461169 461163 461156 462077 461351 461348 461345
      1189 461128 298575 461535 457289 4056 460199 1191 446916 459912 3846 461437 3484 4325 10141 451627 9097 4115 461259 4278 6385 2448 2447 461303 4020 9287 16687 58935 275142 274469 461362 3649 445444 453125 272778 460853 3694 461315 3081 455592 146321 31082 10585 3832 461152 269423 269061 268715 268400 461206 3701 8199 450393 450936 459000 3222 459853 3314 455884 266354 266053 265718 3518 460614 2482 457884 457099 264620 4084 1972 594 460841 461825 457857 2390 460568 3397 7265 447933 14322 5259 3094 459788 2856 458762 457235 261709 456169 3354 460811 2098 457275 455595 1785 460786 260644 460385 1401 1521 5235 2336 460223 3064 459574 702 14398 459311 2888 460040 2364 4052 6008 8173 452605 260879 460791 1756 2335 3981'
    []
  []

