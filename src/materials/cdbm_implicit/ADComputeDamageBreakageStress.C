//* This file is part of the MOOSE framework
//* https://www.mooseframework.org
//*
//* All rights reserved, see COPYRIGHT for full restrictions
//* https://github.com/idaholab/moose/blob/master/COPYRIGHT
//*
//* Licensed under LGPL 2.1, please see LICENSE for details
//* https://www.gnu.org/licenses/lgpl-2.1.html

#include "ADComputeDamageBreakageStress.h"
#include "RankTwoTensor.h"
#include "RankFourTensor.h"
#include "SymmetricRankTwoTensor.h"
#include "SymmetricRankFourTensor.h"

registerMooseObject("farmsApp", ADComputeDamageBreakageStress);
//registerMooseObject("farmsApp", ADSymmetricDamageBreakageStress); //?

//template <typename RankTwoTensor, typename R4, typename ADReal>
InputParameters
ADComputeDamageBreakageStress::validParams()
{
  InputParameters params = ADComputeDamageBreakageStressBase::validParams();
  params.addClassDescription("Compute stress using elasticity for small strains");

  //constant parameters
  params.addRequiredParam<Real>(            "xi_0", "strain invariants ratio: onset of damage evolution");
  params.addRequiredParam<Real>(            "xi_d", "strain invariants ratio: onset of breakage healing");
  params.addRequiredParam<Real>(            "xi_1", "critical point of three phases");
  params.addRequiredParam<Real>(          "xi_min", "strain invariants ratio: minimum allowable value");
  params.addRequiredParam<Real>(          "xi_max", "strain invariants ratio: maximum allowable value");
  params.addRequiredParam<Real>(              "a0", "parameters in granular states");
  params.addRequiredParam<Real>(              "a1", "parameters in granular states");
  params.addRequiredParam<Real>(              "a2", "parameters in granular states");
  params.addRequiredParam<Real>(              "a3", "parameters in granular states");
  params.addRequiredParam<Real>( "gamma_damaged_r", "coefficient of damage solid modulus");
  params.addRequiredParam<Real>(             "C_g", "material parameter: compliance or fluidity of the fine grain granular material");
  params.addRequiredParam<Real>(              "m1", "coefficient of std::power law indexes");
  params.addRequiredParam<Real>(              "m2", "coefficient of std::power law indexes");
  params.addRequiredParam<Real>(               "D", "coefficient of alpha gradient");

  //variable parameters
  params.addRequiredCoupledVar("alpha_in", "damage variable computed from subApp");
  params.addRequiredCoupledVar(    "B_in", "breakage variable computed from subApp");
  params.addRequiredCoupledVar("alpha_grad_x", "damage variable gradient component in x computed from subApp");
  params.addRequiredCoupledVar("alpha_grad_y", "damage variable gradient component in y computed from subApp");
  params.addRequiredCoupledVar("alpha_grad_z", "damage variable gradient component in z computed from subApp");

  return params;
}

//template <typename RankTwoTensor, typename R4, typename ADReal>
ADComputeDamageBreakageStress::ADComputeDamageBreakageStress(
    const InputParameters & parameters)
  : ADComputeDamageBreakageStressBase(parameters),
    //_elasticity_tensor_name(_base_name + "elasticity_tensor"),
    //_elasticity_tensor(getADMaterialProperty<RankFourTensor>(_elasticity_tensor_name)),
    _static_initial_stress_tensor(getADMaterialProperty<RankTwoTensor>("static_initial_stress_tensor")),
    _static_initial_strain_tensor(getADMaterialProperty<RankTwoTensor>("static_initial_strain_tensor")),
    _xi_0(getParam<Real>("xi_0")),
    _xi_d(getParam<Real>("xi_d")),
    _xi_1(getParam<Real>("xi_1")),
    _xi_min(getParam<Real>("xi_min")),
    _xi_max(getParam<Real>("xi_max")),
    _a0(getParam<Real>("a0")),
    _a1(getParam<Real>("a1")),
    _a2(getParam<Real>("a2")),
    _a3(getParam<Real>("a3")),
    _gamma_damaged_r(getParam<Real>("gamma_damaged_r")),
    _C_g(getParam<Real>("C_g")),
    _m1(getParam<Real>("m1")),
    _m2(getParam<Real>("m2")),
    _alpha_damagedvar_old(getMaterialPropertyOld<Real>("alpha_damagedvar")),
    _B_old(getMaterialPropertyOld<Real>("B")),
    _xi_old(getMaterialPropertyOld<Real>("xi")),
    _I1_old(getMaterialPropertyOld<Real>("I1")),
    _I2_old(getMaterialPropertyOld<Real>("I2")),
    _lambda_old(getMaterialPropertyOld<Real>("lambda")),
    _shear_modulus_old(getMaterialPropertyOld<Real>("shear_modulus")),
    _gamma_damaged_old(getMaterialPropertyOld<Real>("gamma_damaged")),
    _eps_total_old(getMaterialPropertyOld<RankTwoTensor>("eps_total")),
    _mechanical_strain_old(getMaterialPropertyOld<RankTwoTensor>("mechanical_strain")),
    _eps_p_old(getMaterialPropertyOld<RankTwoTensor>("eps_p")),
    _eps_e_old(getMaterialPropertyOld<RankTwoTensor>("eps_e")),
    _alpha_in(adCoupledValue("alpha_in")),
    _B_in(adCoupledValue("B_in")),
    _alpha_grad_x(adCoupledValue("alpha_grad_x")),
    _alpha_grad_y(adCoupledValue("alpha_grad_y")),
    _alpha_grad_z(adCoupledValue("alpha_grad_z")),
    _density_old(getADMaterialProperty<Real>("density")),
    _D(getParam<Real>("D"))    
{
}

//template <typename RankTwoTensor, typename R4, typename ADReal>
void
ADComputeDamageBreakageStress::initialSetup()
{
  if ( hasBlockMaterialProperty<RankTwoTensor>(_base_name + "strain_increment"))
    mooseError("This linear elastic stress calculation only works for small strains; use "
               "ADComputeFiniteStrainElasticStress for simulations using incremental and finite "
               "strains.");
}

//template <typename RankTwoTensor, typename R4, typename ADReal>
void
ADComputeDamageBreakageStress::computeQpStress()
{

  /* 
  compute alpha and B parameters
  */

  //alpha, B are updated
  ADReal alpha_out = _alpha_in[_qp];
  ADReal B_out = _B_in[_qp];

  //grad_alpha
  ADReal alpha_grad_x = _alpha_grad_x[_qp];
  ADReal alpha_grad_y = _alpha_grad_y[_qp];
  ADReal alpha_grad_z = _alpha_grad_z[_qp];
  ADReal D = _D;

  //save alpha and B
  _alpha_damagedvar[_qp] = _alpha_in[_qp];
  _B[_qp] = _B_in[_qp];

  /*
  update modulus
  */

  //lambda, shear_modulus, gamma_damaged are updated
  ADReal lambda_out = _lambda_o;
  ADReal shear_modulus_out = _shear_modulus_o + alpha_out * _xi_0 * _gamma_damaged_r;
  ADReal gamma_damaged_out = alpha_out * _gamma_damaged_r;

  //save
  _lambda[_qp] = lambda_out;
  _shear_modulus[_qp] = shear_modulus_out;
  _gamma_damaged[_qp] = gamma_damaged_out;  

  /*
    compute strain
  */  

  //eps_p, eps_e, eps_total are updated
  //Retrieve parameter values
  //strain: total, viscoelastic
  ADRankTwoTensor eps_total_change = _mechanical_strain[_qp];
  RankTwoTensor eps_total_change_old = _mechanical_strain_old[_qp];
  ADRankTwoTensor eps_total_change_inc = eps_total_change - eps_total_change_old;

  //get total strain (add increment)
  ADRankTwoTensor eps_total = _eps_total_old[_qp] + eps_total_change_inc;

  //take the viscoelastic strain from the previous time step
  RankTwoTensor eps_viscoelastic = _eps_p_old[_qp];
    
  //take updated parameters
  ADReal lambda = lambda_out;
  ADReal shear_modulus = shear_modulus_out;
  ADReal gamma_damaged = gamma_damaged_out;
  ADReal B = B_out;

  //Define components
  ADReal eps11p_pre = eps_viscoelastic(0,0);
  ADReal eps22p_pre = eps_viscoelastic(1,1);
  ADReal eps33p_pre = eps_viscoelastic(2,2);
  ADReal eps12p_pre = eps_viscoelastic(0,1);
  ADReal eps13p_pre = eps_viscoelastic(0,2);
  ADReal eps23p_pre = eps_viscoelastic(1,2);
  ADReal eps11t = eps_total(0,0);
  ADReal eps22t = eps_total(1,1);
  ADReal eps33t = eps_total(2,2);
  ADReal eps12t = eps_total(0,1);
  ADReal eps13t = eps_total(0,2);
  ADReal eps23t = eps_total(1,2);

  auto compute = [&](const ADNestedSolve::Value<> & guess,
                      ADNestedSolve::Value<> & residual,
                      ADNestedSolve::Jacobian<> & jacobian)
  {
      //current viscoelastic strain (with increment unknown)
      //Note: 
      //guess(0) = eps11p_inc
      //guess(1) = eps22p_inc
      //guess(2) = eps33p_inc
      //guess(3) = eps12p_inc
      //guess(4) = eps13p_inc
      //guess(5) = eps23p_inc

      ADReal eps11p = eps11p_pre + guess(0);
      ADReal eps22p = eps22p_pre + guess(1);
      ADReal eps33p = eps33p_pre + guess(2);
      ADReal eps12p = eps12p_pre + guess(3);
      ADReal eps13p = eps13p_pre + guess(4);
      ADReal eps23p = eps23p_pre + guess(5);

      //compute elastic strain
      ADReal eps11e = eps11t - eps11p;
      ADReal eps22e = eps22t - eps22p;
      ADReal eps33e = eps33t - eps33p;
      ADReal eps12e = eps12t - eps12p;
      ADReal eps13e = eps13t - eps13p;
      ADReal eps23e = eps23t - eps23p;

      //represent I1 I2 xi using elastic strain
      ADReal I1 = eps11e + eps22e + eps33e;
      ADReal I2 = eps11e * eps11e + eps22e * eps22e + eps33e * eps33e + 2 * eps12e * eps12e + 2 * eps13e * eps13e + 2 * eps23e * eps23e;
      ADReal xi = I1 / std::sqrt(I2);

      //Represent sigma (solid(s) + granular(b))
      ADReal sigma11_s = ( lambda - gamma_damaged / xi ) * I1 + ( 2 * shear_modulus - gamma_damaged * xi ) * eps11e;
      ADReal sigma11_b = ( 2 * _a2 + _a1 / xi + 3 * _a3 * xi ) * I1 + ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps11e;
      ADReal sigma22_s = ( lambda - gamma_damaged / xi ) * I1 + ( 2 * shear_modulus - gamma_damaged * xi ) * eps22e;
      ADReal sigma22_b = ( 2 * _a2 + _a1 / xi + 3 * _a3 * xi ) * I1 + ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps22e;
      ADReal sigma33_s = ( lambda - gamma_damaged / xi ) * I1 + ( 2 * shear_modulus - gamma_damaged * xi ) * eps33e;
      ADReal sigma33_b = ( 2 * _a2 + _a1 / xi + 3 * _a3 * xi ) * I1 + ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps33e;
      ADReal sigma12_s = ( 2 * shear_modulus - gamma_damaged * xi ) * eps12e;
      ADReal sigma12_b = ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps12e;
      ADReal sigma13_s = ( 2 * shear_modulus - gamma_damaged * xi ) * eps13e;
      ADReal sigma13_b = ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps13e;
      ADReal sigma23_s = ( 2 * shear_modulus - gamma_damaged * xi ) * eps23e;
      ADReal sigma23_b = ( 2 * _a0 + _a1 * xi - _a3 * std::pow(xi,3) ) * eps23e;

      //Represent total stress
      ADReal sigma11_t = (1 - B) * sigma11_s + B * sigma11_b;
      ADReal sigma22_t = (1 - B) * sigma22_s + B * sigma22_b;
      ADReal sigma33_t = (1 - B) * sigma33_s + B * sigma33_b;
      ADReal sigma12_t = (1 - B) * sigma12_s + B * sigma12_b;
      ADReal sigma13_t = (1 - B) * sigma13_s + B * sigma13_b;
      ADReal sigma23_t = (1 - B) * sigma23_s + B * sigma23_b;

      //Represent deviatoric stress
      ADReal sigma_d11 = sigma11_t - 1/3 * (sigma11_t + sigma22_t + sigma33_t);
      ADReal sigma_d22 = sigma22_t - 1/3 * (sigma11_t + sigma22_t + sigma33_t);
      ADReal sigma_d33 = sigma33_t - 1/3 * (sigma11_t + sigma22_t + sigma33_t);
      ADReal sigma_d12 = sigma12_t;
      ADReal sigma_d13 = sigma13_t;
      ADReal sigma_d23 = sigma23_t;

      //Setup equations
      ///residual
      residual(0) = guess(0) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d11,_m2);
      residual(1) = guess(1) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d22,_m2);
      residual(2) = guess(2) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d33,_m2);
      residual(3) = guess(3) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d12,_m2);
      residual(4) = guess(4) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d13,_m2);
      residual(5) = guess(5) - _dt * _C_g * std::pow(B,_m1) * std::pow(sigma_d23,_m2);

      ///jacobian //too long ...
      ///Define parameters
      ADReal minus_eps11e = guess(0) - eps11t + eps11p_pre;
      ADReal minus_eps22e = guess(1) - eps22t + eps22p_pre;
      ADReal minus_eps33e = guess(2) - eps33t + eps33p_pre;
      ADReal minus_eps12e = guess(3) - eps12t + eps12p_pre;
      ADReal minus_eps13e = guess(4) - eps13t + eps13p_pre;
      ADReal minus_eps23e = guess(5) - eps23t + eps23p_pre;
      ADReal minus_eps_tr = minus_eps11e + minus_eps22e + minus_eps33e;
      ADReal minus_epse_I2 = std::pow(minus_eps11e,2) + 2*std::pow(minus_eps12e,2) + std::pow(minus_eps22e,2) + std::pow(minus_eps33e,2) + 2*std::pow(minus_eps13e,2) + 2*std::pow(minus_eps23e,2);
      jacobian(0,0) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*(((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3) + 1;
      jacobian(0,1) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(0,2) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(0,3) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((2*B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*(B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(0,4) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((2*B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*(B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(0,5) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((2*B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*(B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(1,0) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(1,1) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*(((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3) + 1;
      jacobian(1,2) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(1,3) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(1,4) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(1,5) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(2,0) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps11e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(2,1) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + ((B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps22e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3);
      jacobian(2,2) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*(((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps11e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*B*((minus_eps33e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 - 2*_a0 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr) - (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)))/3 + ((B - 1)*(lambda - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps22e) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 - (2*(B - 1)*(lambda + 2*shear_modulus - ((gamma_damaged*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (gamma_damaged*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(minus_eps33e) + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps11e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3 + (B*((minus_eps22e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))) - 2*_a2 + ((3*_a3)/std::pow(minus_epse_I2,0.5) - (_a1*std::pow(minus_epse_I2,0.5))/std::pow(minus_eps_tr,2.0) - (3*_a3*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (_a1*(2*minus_eps33e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr) + (3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr)))/3) + 1;
      jacobian(2,3) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps12e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps12e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(2,4) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps13e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps13e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(2,5) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((2*((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps33e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps22e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 - (((2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps11e) + (lambda + (gamma_damaged*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr))*(B - 1))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps11e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 + (B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps22e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3 - (2*B*((2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps33e) - ((3*_a3*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) - 2*_a2 + (_a1*std::pow(minus_epse_I2,0.5))/(minus_eps_tr))*(minus_eps_tr)))/3,_m2 - 1)*((B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps11e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 + (B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps22e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - (2*B*(((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps33e) + ((3*_a3*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (_a1*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)*(minus_eps_tr)))*(minus_eps_tr)))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 - ((B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3 + (2*(B - 1)*((gamma_damaged*(4*minus_eps23e))/(2*std::pow(minus_epse_I2,0.5)) - (gamma_damaged*(4*minus_eps23e)*(minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))))/3);
      jacobian(3,0) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps12e) + B*(minus_eps12e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(3,1) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps12e) + B*(minus_eps12e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(3,2) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps12e) + B*(minus_eps12e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(3,3) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*(B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)) - (B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5)) + B*((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps12e) + (gamma_damaged*(B - 1)*(4*minus_eps12e)*(minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))) + 1;
      jacobian(3,4) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*(B*((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps12e) + (gamma_damaged*(B - 1)*(4*minus_eps13e)*(minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)));
      jacobian(3,5) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps12e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps12e),_m2 - 1)*(B*((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps12e) + (gamma_damaged*(B - 1)*(4*minus_eps23e)*(minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))); 
      jacobian(4,0) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps13e) + B*(minus_eps13e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(4,1) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps13e) + B*(minus_eps13e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(4,2) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps13e) + B*(minus_eps13e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(4,3) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*(B*((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps13e) + (gamma_damaged*(B - 1)*(4*minus_eps12e)*(minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)));
      jacobian(4,4) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*(B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)) - (B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5)) + B*((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps13e) + (gamma_damaged*(B - 1)*(4*minus_eps13e)*(minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))) + 1;
      jacobian(4,5) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps13e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps13e),_m2 - 1)*(B*((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps13e) + (gamma_damaged*(B - 1)*(4*minus_eps23e)*(minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))); 
      jacobian(5,0) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps23e) + B*(minus_eps23e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps11e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps11e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(5,1) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps23e) + B*(minus_eps23e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps22e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps22e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(5,2) = -std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*((gamma_damaged/std::pow(minus_epse_I2,0.5) - (gamma_damaged*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)))*(B - 1)*(minus_eps23e) + B*(minus_eps23e)*(_a1/std::pow(minus_epse_I2,0.5) - (3*_a3*std::pow(minus_eps_tr,2.0))/std::pow(minus_epse_I2,1.5) - (_a1*(2*minus_eps33e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) + (3*_a3*(2*minus_eps33e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5))));
      jacobian(5,3) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*(B*((_a1*(4*minus_eps12e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps12e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps23e) + (gamma_damaged*(B - 1)*(4*minus_eps12e)*(minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)));
      jacobian(5,4) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*(B*((_a1*(4*minus_eps13e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps13e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps23e) + (gamma_damaged*(B - 1)*(4*minus_eps13e)*(minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)));
      jacobian(5,5) = std::pow(B,_m1)*_C_g*_dt*_m2*std::pow((B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5))*(minus_eps23e) - B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5))*(minus_eps23e),_m2 - 1)*(B*(2*_a0 - (_a1*(minus_eps_tr))/std::pow(minus_epse_I2,0.5) + (_a3*std::pow(minus_eps_tr,3.0))/std::pow(minus_epse_I2,1.5)) - (B - 1)*(2*shear_modulus + (gamma_damaged*(minus_eps_tr))/std::pow(minus_epse_I2,0.5)) + B*((_a1*(4*minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5)) - (3*_a3*(4*minus_eps23e)*std::pow(minus_eps_tr,3.0))/(2*std::pow(minus_epse_I2,2.5)))*(minus_eps23e) + (gamma_damaged*(B - 1)*(4*minus_eps23e)*(minus_eps23e)*(minus_eps_tr))/(2*std::pow(minus_epse_I2,1.5))) + 1; 
  };   

  ADNestedSolve solver;
  ADNestedSolve::Value<> solution(6);
  solution << 0, 0, 0, 0, 0, 0;
  solver.setAbsoluteTolerance(1e-10);
  solver.setRelativeTolerance(1e-8);
  solver.nonlinear(solution, compute);

  //take solution
  ADReal eps11p_inc = solution(0);
  ADReal eps22p_inc = solution(1);
  ADReal eps33p_inc = solution(2);
  ADReal eps12p_inc = solution(3);
  ADReal eps13p_inc = solution(4);
  ADReal eps23p_inc = solution(5);    

  //save data
  //viscoelastic strain
  ADRankTwoTensor eps_p_out;
  eps_p_out(0,0) = eps11p_pre + eps11p_inc;
  eps_p_out(1,1) = eps22p_pre + eps22p_inc;
  eps_p_out(0,1) = eps12p_pre + eps12p_inc;
  eps_p_out(1,0) = eps12p_pre + eps12p_inc;
  eps_p_out(0,2) = eps13p_pre + eps13p_inc;
  eps_p_out(2,0) = eps13p_pre + eps13p_inc;
  eps_p_out(1,2) = eps23p_pre + eps23p_inc;
  eps_p_out(2,1) = eps23p_pre + eps23p_inc;
  eps_p_out(2,2) = eps33p_pre + eps33p_inc;
  _eps_p[_qp] = eps_p_out;

  //elastic strain
  ADRankTwoTensor eps_e_out;
  ADReal eps11e_out = eps11t - ( eps11p_pre + eps11p_inc );
  ADReal eps22e_out = eps22t - ( eps22p_pre + eps22p_inc );
  ADReal eps33e_out = eps33t - ( eps33p_pre + eps33p_inc );
  ADReal eps12e_out = eps12t - ( eps12p_pre + eps12p_inc );
  ADReal eps13e_out = eps13t - ( eps13p_pre + eps13p_inc );
  ADReal eps23e_out = eps23t - ( eps23p_pre + eps23p_inc );
  eps_e_out(0,0) = eps11e_out;
  eps_e_out(1,1) = eps22e_out;
  eps_e_out(0,1) = eps12e_out;
  eps_e_out(1,0) = eps12e_out;
  eps_e_out(0,2) = eps13e_out;
  eps_e_out(2,0) = eps13e_out;
  eps_e_out(1,2) = eps23e_out;
  eps_e_out(2,1) = eps23e_out;
  eps_e_out(2,2) = eps33e_out;
  _eps_e[_qp] = eps_e_out;

  //total strain
  ADRankTwoTensor eps_total_out;
  eps_total_out(0,0) = eps11t;
  eps_total_out(1,1) = eps22t;
  eps_total_out(0,1) = eps12t;
  eps_total_out(1,0) = eps12t;
  eps_total_out(0,2) = eps13t;
  eps_total_out(2,0) = eps13t;
  eps_total_out(1,2) = eps23t;
  eps_total_out(2,1) = eps23t;
  eps_total_out(2,2) = eps33t;
  _eps_total[_qp] = eps_total_out;

  /*
    compute I1 I2 xi
  */

  //I1, I2, xi are updated
  
  ADReal I1_out = eps11e_out + eps22e_out + eps33e_out;
  ADReal I2_out = eps11e_out * eps11e_out + eps22e_out * eps22e_out + eps33e_out * eps33e_out + 2 * eps12e_out * eps12e_out + 2 * eps13e_out * eps13e_out + 2 * eps23e_out * eps23e_out;
  ADReal xi_out = I1_out / std::sqrt(I2_out);

  //save
  _I1[_qp] = I1_out;
  _I2[_qp] = I2_out;
  _xi[_qp] = xi_out; 

  //compute stress
  //sts_total, stress are updated
  //feed total stress
  ADRankTwoTensor stress_total_out;
  stress_total_out(0,0) = ( 1 - B ) * ( ( lambda - gamma_damaged / xi_out ) * I1_out + ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps11e_out ) + B * ( ( 2 * _a2 + _a1 / xi_out + 3 * _a3 * xi_out ) * I1_out + ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps11e_out );
  stress_total_out(1,1) = ( 1 - B ) * ( ( lambda - gamma_damaged / xi_out ) * I1_out + ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps22e_out ) + B * ( ( 2 * _a2 + _a1 / xi_out + 3 * _a3 * xi_out ) * I1_out + ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps22e_out );
  stress_total_out(2,2) = ( 1 - B ) * ( ( lambda - gamma_damaged / xi_out ) * I1_out + ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps33e_out ) + B * ( ( 2 * _a2 + _a1 / xi_out + 3 * _a3 * xi_out ) * I1_out + ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps33e_out );
  stress_total_out(0,1) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps12e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps12e_out );
  stress_total_out(1,0) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps12e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps12e_out );
  stress_total_out(0,2) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps13e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps13e_out );
  stress_total_out(2,0) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps13e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps13e_out );
  stress_total_out(1,2) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps23e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps23e_out );
  stress_total_out(2,1) = ( 1 - B ) * ( ( 2 * shear_modulus - gamma_damaged * xi_out ) * eps23e_out ) + B * ( ( 2 * _a0 + _a1 * xi_out - _a3 * std::pow(xi_out,3) ) * eps23e_out );

  //_sts_total[_qp] = stress_total_out;

  //feed stress change (relative to initial condition) to system
  ADRankTwoTensor stress_out;
  ADRankTwoTensor stress_initial = _static_initial_stress_tensor[_qp];
  stress_out(0,0) = stress_total_out(0,0) - stress_initial(0,0);
  stress_out(1,1) = stress_total_out(1,1) - stress_initial(1,1);
  stress_out(2,2) = stress_total_out(2,2) - stress_initial(2,2);
  stress_out(0,1) = stress_total_out(0,1) - stress_initial(0,1);
  stress_out(1,0) = stress_total_out(1,0) - stress_initial(1,0);
  stress_out(0,2) = stress_total_out(0,2) - stress_initial(0,2);
  stress_out(2,0) = stress_total_out(2,0) - stress_initial(2,0);
  stress_out(1,2) = stress_total_out(1,2) - stress_initial(1,2);
  stress_out(2,1) = stress_total_out(2,1) - stress_initial(2,1);

  // stress = C * e
  _stress[_qp] = stress_out;

  // Assign value for elastic strain, which is equal to the mechanical strain
  _elastic_strain[_qp] = _mechanical_strain[_qp];
}

//template class ADComputeDamageBreakageStressTempl<RankTwoTensor, RankFourTensor, ADReal>;
//template class ADComputeDamageBreakageStressTempl<SymmetricRankTwoTensor, SymmetricRankFourTensor>;