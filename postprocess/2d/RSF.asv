clear all; close all; clc;
%% 25 m mesh

x=[4.99999998e-13 7.36089466e-13 4.56715846e-11 1.25440422e-08
 1.66396433e-06 7.53136774e-05 1.28815556e-03 9.61740594e-03
 3.67698669e-02 9.18811709e-02 1.91141233e-01 4.35591012e-01
 1.23793626e+00 2.71993566e+00 2.37850118e+00 2.21734953e+00
 2.13345098e+00 2.05361366e+00 1.96068990e+00 1.84840763e+00
 1.70503891e+00 1.52706695e+00 1.37287629e+00 1.25546527e+00
 1.13325477e+00 9.93604422e-01 9.03563857e-01 9.21513855e-01
 9.20348167e-01 8.88080180e-01 8.33909154e-01 7.72925675e-01
 7.62875259e-01 7.69145906e-01 7.73060918e-01 7.65519738e-01
 7.56149709e-01 7.46793389e-01 7.37705410e-01 7.29188323e-01
 7.21208572e-01 7.14156449e-01 7.07869768e-01 7.01976001e-01
 6.96858227e-01 6.92594886e-01 6.88464105e-01 6.84814930e-01
 6.81378067e-01 6.77921832e-01 6.74073994e-01 6.70942783e-01
 6.68092728e-01 6.64825618e-01 6.61244035e-01 6.57143593e-01
 6.53970957e-01 6.51396930e-01 6.48595154e-01 6.46214664e-01
 6.44582748e-01 6.42896235e-01 6.42055750e-01 6.40168250e-01
 6.37691736e-01 6.33148551e-01 6.32380545e-01 6.32195413e-01
 6.30219519e-01 6.27292931e-01 6.26245618e-01 6.24984443e-01
 6.22142255e-01 6.22006059e-01 6.19897664e-01 6.18832648e-01
 6.16643488e-01 6.15761518e-01 6.14897132e-01 6.13352597e-01
 6.12995148e-01 6.10507369e-01 6.09020948e-01 6.07636988e-01
 6.07213676e-01 6.07553065e-01 6.04033887e-01 6.05201781e-01
 6.02733314e-01 5.98541379e-01 5.87732553e-01 5.64860761e-01
 5.31685293e-01 4.89068329e-01 4.51737553e-01 4.19155270e-01
 3.95477414e-01 3.74319196e-01 3.56022477e-01 3.40467483e-01
 3.25676560e-01 3.14160883e-01 3.03436697e-01 2.93195605e-01
 2.85477430e-01 2.77912855e-01 2.72151768e-01 2.67067879e-01
 2.63439208e-01 2.61876225e-01 2.62606204e-01 2.67086178e-01
 2.73980021e-01 2.83341795e-01 2.90621221e-01 2.88833708e-01
 2.75791109e-01 2.52762318e-01 2.23569438e-01 1.97951511e-01
 1.77292302e-01 1.61231920e-01 1.48752481e-01 1.38430163e-01
 1.28589377e-01 1.17663138e-01 1.06888473e-01 9.73418206e-02
 8.86963829e-02 7.99379051e-02 7.24008828e-02 6.90032244e-02
 7.22140893e-02 8.40234309e-02 1.04155846e-01 1.25438869e-01
 1.37634724e-01 1.41433835e-01 1.44870162e-01 1.50530457e-01
 1.55172318e-01 1.56306103e-01 1.55960381e-01 1.56816959e-01
 1.59680113e-01 1.65307030e-01 1.76585168e-01 1.95611790e-01];

 time = [0 0.0000000000e+00
20 1.0103926097e-01
40 2.0207852194e-01
60 3.0311778291e-01
80 4.0415704388e-01
100 5.0519630485e-01
120 6.0623556582e-01
140 7.0727482679e-01
160 8.0831408776e-01
180 9.0935334873e-01
200 1.0103926097e+00
220 1.1114318707e+00
240 1.2124711316e+00
260 1.3135103926e+00
280 1.4145496536e+00
300 1.5155889145e+00
320 1.6166281755e+00
340 1.7176674365e+00
360 1.8187066975e+00
380 1.9197459584e+00
400 2.0207852194e+00
420 2.1218244804e+00
440 2.2228637413e+00
460 2.3239030023e+00
480 2.4249422633e+00
500 2.5259815242e+00
520 2.6270207852e+00
540 2.7280600462e+00
560 2.8290993072e+00
580 2.9301385681e+00
600 3.0311778291e+00
620 3.1322170901e+00
640 3.2332563510e+00
660 3.3342956120e+00
680 3.4353348730e+00
700 3.5363741339e+00
720 3.6374133949e+00
740 3.7384526559e+00
760 3.8394919169e+00
780 3.9405311778e+00
800 4.0415704388e+00
820 4.1426096998e+00
840 4.2436489607e+00
860 4.3446882217e+00
880 4.4457274827e+00
900 4.5467667436e+00
920 4.6478060046e+00
940 4.7488452656e+00
960 4.8498845266e+00
980 4.9509237875e+00
1000 5.0519630485e+00
1020 5.1530023095e+00
1040 5.2540415704e+00
1060 5.3550808314e+00
1080 5.4561200924e+00
1100 5.5571593533e+00
1120 5.6581986143e+00
1140 5.7592378753e+00
1160 5.8602771363e+00
1180 5.9613163972e+00
1200 6.0623556582e+00
1220 6.1633949192e+00
1240 6.2644341801e+00
1260 6.3654734411e+00
1280 6.4665127021e+00
1300 6.5675519630e+00
1320 6.6685912240e+00
1340 6.7696304850e+00
1360 6.8706697460e+00
1380 6.9717090069e+00
1400 7.0727482679e+00
1420 7.1737875289e+00
1440 7.2748267898e+00
1460 7.3758660508e+00
1480 7.4769053118e+00
1500 7.5779445727e+00
1520 7.6789838337e+00
1540 7.7800230947e+00
1560 7.8810623557e+00
1580 7.9821016166e+00
1600 8.0831408776e+00
1620 8.1841801386e+00
1640 8.2852193995e+00
1660 8.3862586605e+00
1680 8.4872979215e+00
1700 8.5883371824e+00
1720 8.6893764434e+00
1740 8.7904157044e+00
1760 8.8914549654e+00
1780 8.9924942263e+00
1800 9.0935334873e+00
1820 9.1945727483e+00
1840 9.2956120092e+00
1860 9.3966512702e+00
1880 9.4976905312e+00
1900 9.5987297921e+00
1920 9.6997690531e+00
1940 9.8008083141e+00
1960 9.9018475751e+00
1980 1.0002886836e+01
2000 1.0103926097e+01
2020 1.0204965358e+01
2040 1.0306004619e+01
2060 1.0407043880e+01
2080 1.0508083141e+01
2100 1.0609122402e+01
2120 1.0710161663e+01
2140 1.0811200924e+01
2160 1.0912240185e+01
2180 1.1013279446e+01
2200 1.1114318707e+01
2220 1.1215357968e+01
2240 1.1316397229e+01
2260 1.1417436490e+01
2280 1.1518475751e+01
2300 1.1619515012e+01
2320 1.1720554273e+01
2340 1.1821593533e+01
2360 1.1922632794e+01
2380 1.2023672055e+01
2400 1.2124711316e+01
2420 1.2225750577e+01
2440 1.2326789838e+01
2460 1.2427829099e+01
2480 1.2528868360e+01
2500 1.2629907621e+01
2520 1.2730946882e+01
2540 1.2831986143e+01
2560 1.2933025404e+01
2580 1.3034064665e+01
2600 1.3135103926e+01
2620 1.3236143187e+01
2640 1.3337182448e+01
2660 1.3438221709e+01
2680 1.3539260970e+01
2700 1.3640300231e+01
2720 1.3741339492e+01
2740 1.3842378753e+01
2760 1.3943418014e+01
2780 1.4044457275e+01
2800 1.4145496536e+01
2820 1.4246535797e+01
2840 1.4347575058e+01
2860 1.4448614319e+01
2880 1.4549653580e+01
2900 1.4650692841e+01
2920 1.4751732102e+01
2940 1.4852771363e+01
2960 1.4953810624e+01];

 xa = reshape(x',37*4,1);
 plot(time(2:end,2),xa*2); hold on;
%% 100 m
x=[5.0000000e-13 7.3661227e-13 4.5669701e-11 1.2544041e-08 1.6639646e-06
 7.5313663e-05 1.2879953e-03 9.6009383e-03 3.6486041e-02 9.0260573e-02
 1.8550649e-01 4.1755819e-01 1.1710459e+00 2.6996448e+00 2.3927124e+00
 2.1903002e+00 1.9829391e+00 2.1269948e+00 1.9503220e+00 1.8686366e+00
 1.7547904e+00 1.3408226e+00 1.2742796e+00 1.3387966e+00 1.1639490e+00
 9.3633276e-01 8.3423847e-01 7.8703153e-01 7.8326070e-01 8.3173579e-01
 8.7003869e-01 8.1755710e-01 7.4987042e-01 9.1294646e-01 9.2810011e-01
 8.2246161e-01 8.3543080e-01 9.1315657e-01 8.6469370e-01 7.7691370e-01
 7.7030772e-01 7.9018402e-01 7.7540302e-01 7.1487021e-01 6.8290788e-01
 6.9660783e-01 6.9737417e-01 6.6617662e-01 6.3230151e-01 6.3438320e-01
 6.4930475e-01 6.3940489e-01 6.1148340e-01 6.0077477e-01 6.2328827e-01
 6.3240081e-01 6.0059702e-01 5.8490056e-01 6.1511606e-01 6.3158494e-01
 6.0051399e-01 5.8140492e-01 6.0319042e-01 6.3333529e-01 6.1479795e-01
 5.7927942e-01 6.0189337e-01 6.3532841e-01 6.0371077e-01 5.8870280e-01
 6.0578084e-01 6.2352252e-01 6.1305147e-01 5.8750808e-01 5.9674233e-01
 6.2335992e-01 6.2464935e-01 5.9894437e-01 5.9105438e-01 6.1561799e-01
 6.2741637e-01 6.1301345e-01 5.9846354e-01 6.0782266e-01 6.1863858e-01
 6.2165087e-01 6.0806519e-01 6.0125363e-01 6.0985857e-01 6.1899328e-01
 6.0211772e-01 5.7224929e-01 5.3122687e-01 4.8638627e-01 4.4800082e-01
 4.1072056e-01 3.8554662e-01 3.7378895e-01 3.6562103e-01 3.5126501e-01
 3.3517948e-01 3.1930172e-01 3.0837631e-01 2.9814294e-01 2.9103985e-01
 2.8396216e-01 2.7768910e-01 2.7303469e-01 2.6834273e-01 2.6755795e-01
 2.6562902e-01 2.6807883e-01 2.7891007e-01 2.8652930e-01 2.8711447e-01
 2.9066387e-01 2.7516758e-01 2.4895155e-01 2.2834460e-01 2.0318207e-01
 1.8203296e-01 1.6693953e-01 1.5366000e-01 1.4233784e-01 1.3239418e-01
 1.2258355e-01 1.1093930e-01 1.0096208e-01 9.1603652e-02 8.3037928e-02
 7.4952923e-02 7.1179859e-02 7.4469358e-02 8.6710364e-02 1.0892812e-01
 1.2981090e-01 1.4153586e-01 1.4182441e-01 1.4500923e-01 1.4831348e-01
 1.5442874e-01 1.5531865e-01 1.5594798e-01 1.5695469e-01 1.6123177e-01 
 1.6675612e-01 1.7591089e-01 1.9173825e-01 1.9173825e-01 1.9173825e-01];


 xa = reshape(x',30*5,1);
 plot([time(:,2); time(end,2)+0.1],xa*2);hold on;
  % xlim([0 1.7])

 %% 50 m
 x=[4.99999998e-13 7.34748525e-13 4.56698082e-11 1.25440422e-08
 1.66396433e-06 7.53135901e-05 1.28808583e-03 9.61141475e-03
 3.66722308e-02 9.13377777e-02 1.89296335e-01 4.29918855e-01
 1.21819937e+00 2.71162391e+00 2.36595416e+00 2.20108891e+00
 2.15727377e+00 2.03960013e+00 1.99194551e+00 1.82083225e+00
 1.76548612e+00 1.47962832e+00 1.40813494e+00 1.22919703e+00
 1.15799785e+00 1.01357937e+00 9.04232562e-01 8.87260735e-01
 8.83380234e-01 8.66287231e-01 8.48879218e-01 7.85806954e-01
 7.66690433e-01 7.86394179e-01 7.79843748e-01 7.79148281e-01
 7.59161413e-01 7.50854850e-01 7.35125303e-01 7.29363501e-01
 7.14017689e-01 7.11481929e-01 6.99563980e-01 6.99633002e-01
 6.89278543e-01 6.89398587e-01 6.79731905e-01 6.78910017e-01
 6.72096729e-01 6.70890510e-01 6.63536787e-01 6.62317932e-01
 6.61275327e-01 6.53029144e-01 6.57909930e-01 6.47122025e-01
 6.55011594e-01 6.40839040e-01 6.53543890e-01 6.35125041e-01
 6.50477111e-01 6.32205367e-01 6.45767868e-01 6.28805518e-01
 6.42847776e-01 6.24782801e-01 6.36627018e-01 6.25600278e-01
 6.27896309e-01 6.25987530e-01 6.23821199e-01 6.21295333e-01
 6.20731771e-01 6.18244708e-01 6.19114459e-01 6.15077317e-01
 6.16744101e-01 6.12610400e-01 6.13800585e-01 6.11319423e-01
 6.11640632e-01 6.08507216e-01 6.08643591e-01 6.06826127e-01
 6.05928838e-01 6.05456471e-01 6.03180647e-01 6.03078008e-01
 6.00959122e-01 5.98240614e-01 5.86797595e-01 5.65903962e-01
 5.31557560e-01 4.90915239e-01 4.52530295e-01 4.19367403e-01
 3.96667510e-01 3.77244920e-01 3.57736439e-01 3.43022704e-01
 3.28799337e-01 3.14883709e-01 3.06151927e-01 2.94569314e-01
 2.87373751e-01 2.79940546e-01 2.73224622e-01 2.69823372e-01
 2.64328986e-01 2.63758779e-01 2.64223218e-01 2.67535657e-01
 2.74437547e-01 2.83913463e-01 2.90606737e-01 2.87960351e-01
 2.75309384e-01 2.53982037e-01 2.26510137e-01 1.99622571e-01
 1.78873509e-01 1.63080886e-01 1.49626702e-01 1.39761224e-01
 1.30474508e-01 1.19929850e-01 1.09221384e-01 9.94748175e-02
 8.99540409e-02 8.06526467e-02 7.27451444e-02 6.93517104e-02
 7.30440244e-02 8.55564550e-02 1.06533214e-01 1.28084898e-01
 1.39543369e-01 1.42524824e-01 1.45558253e-01 1.51291698e-01
 1.56112611e-01 1.57028541e-01 1.56722307e-01 1.58113018e-01
 1.61535189e-01 1.66568726e-01 1.76151842e-01 1.92867562e-01];

 xa = reshape(x',37*4,1);
 plot(time(2:end,2),xa*2)
 %%
 for i = 1 : 121
 filename = join(['./data/100m/data_2d_100m_' num2str(i-1) '.txt']);
 data = readmatrix(filename);
 time_Moose(i) = data(1,1);
 sliprate(i) = data(501,2);
 end
 %%
 for i = 1 : 121
 filename = join(['./data/50m/data_2d_50m_' num2str(i-1) '.txt']);
 data = readmatrix(filename);
 time_Moose2(i) = data(1,1);
 sliprate2(i) = data(501,2);
 end
  %%
 for i = 1 : 121
 filename = join(['./data/50m/data_2d_50m_' num2str(i-1) '.txt']);
 data = readmatrix(filename);
 time_Moose2(i) = data(1,1);
 sliprate2(i) = data(501,2);
 end


%  plot(time_Moose,sliprate,'--k');
%  hold on;
%  plot(time_Moose2,sliprate2,'--m');
%  hold on;
%  plot(time_Moose3,sliprate3,'--r');
%  legend("2nd-order","1st-order","exact-form",'fontsize',12)
%  xlim([0,1.5])
%  hold on;
%  plot(time_Moose4,sliprate4,'-.k');
%  hold on;
%  plot(time_Moose5,sliprate5,'-.m');
%  hold on;
%  plot(time_Moose6,sliprate6,'-.r');
%  legend("2nd-order","1st-order","exact-form",'fontsize',12)
%  xlim([0,1.5])
%  hold on;
% plot(time_Moose8,sliprate8,'--b');
% hold on;
plot(time_Moose,sliprate,'-.b');
hold on;
plot(time_Moose2,sliprate2,'-.m');
legend("100m","25m",'fontsize',12)
xlim([0,3.0])

legend("ugunca - 25m","ugunca - 100m","ugunca - 50m","tangent-jump-rate-100m","tangent-jump-rate-50m","fontsize",12)
